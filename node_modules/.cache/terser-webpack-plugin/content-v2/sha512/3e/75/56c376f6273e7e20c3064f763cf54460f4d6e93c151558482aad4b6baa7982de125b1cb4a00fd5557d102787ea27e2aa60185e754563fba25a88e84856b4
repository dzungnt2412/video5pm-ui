{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"ticket-list\"],{\"1fec\":function(t,e,i){t.exports=i.p+\"img/notfound.005bfa2e.svg\"},2797:function(t,e,i){\"use strict\";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",[i(\"div\",{staticClass:\"row\"},[i(\"div\",{staticClass:\"col-xl-12\"},[i(\"div\",{staticClass:\"px-10 mb-2 panel ticket-toolbar\"},[i(\"a\",{staticClass:\"mr-30\",attrs:{href:\"#\"},on:{click:function(e){return t.toBack()}}},[i(\"p-tooltip\",{attrs:{position:\"bottom\",trigger:\"hover\",label:\"Quay lại\"}},[i(\"span\",{staticClass:\"badge badge-default badge-outline\"},[i(\"i\",{staticClass:\"icon md-arrow-left\"})])])],1),\"closed\"!=t.ticket.status?i(\"a\",{staticClass:\"ml-30 mr-20\",attrs:{href:\"#form-reply-ticket\"}},[i(\"p-tooltip\",{attrs:{position:\"bottom\",trigger:\"hover\",label:\"Trả lời\"}},[i(\"span\",{staticClass:\"badge badge-default badge-outline\"},[i(\"i\",{staticClass:\"icon md-mail-reply\"})])])],1):t._e(),i(\"a\",{staticClass:\"mr-10 float-right\",attrs:{href:\"#ticket-bottom\"}},[i(\"p-tooltip\",{attrs:{position:\"bottom-left\",trigger:\"hover\",label:\"Cuộn xuống\"}},[i(\"span\",{staticClass:\"badge badge-default badge-outline\"},[i(\"i\",{staticClass:\"icon md-long-arrow-down\"})])])],1)])]),i(\"div\",{staticClass:\"col-xl-12\"},[i(\"div\",{staticClass:\"card\"},[i(\"div\",{staticClass:\"card-block\"},[i(\"div\",{staticClass:\"card-title\"},[i(\"h3\",{staticClass:\"m0\"},[t._v(\"\\n              \"+t._s(t.ticket.subject)+\"\\n            \")]),\"closed\"==t.ticket.status?i(\"p\",{staticClass:\"mt-2 mb-0 text-danger\"},[t._v(\"Ticket đã được đóng, nếu sự cố của bạn chưa được giải quết, bạn\\n              có thể click \"),i(\"a\",{attrs:{href:\"#ticket-bottom\"}},[t._v(\"vào đây\")]),t._v(\" để mở lại\\n              ticket.\")]):t._e()]),i(\"div\",{staticClass:\"card-text\"},[i(\"div\",{staticClass:\"row\"},[i(\"div\",{staticClass:\"col-sm-7\"},[i(\"p\",{staticClass:\"mb-5\"},[i(\"span\",[t._v(\"Ticket ID: \"+t._s(t.ticket.id))]),i(\"time\",{staticClass:\"ml-35\"},[t._v(\"\\n                    Tạo ngày:\\n                    \"+t._s(t._f(\"datetime\")(t.ticket.created_at,\"dd/MM/yyyy HH:mm\"))+\" (\"+t._s(t._f(\"timeAgo\")(t.ticket.created_at))+\"\\n                    trước)\\n                  \")])]),t.ticket.object_id?i(\"p\",{staticClass:\"mb-5\"},[t._v(\"\\n                  Mã đơn hàng:\\n                  \"),i(\"router-link\",{staticClass:\"hightlight\",attrs:{slot:\"reference\",target:\"_blank\",to:{name:\"order-view\",params:{id:t.ticket.object_id}}},slot:\"reference\"},[t._v(\"\\n                    \"+t._s(t.ticket.ref_id)+\"\\n                  \")])],1):t._e()]),i(\"div\",{staticClass:\"col-sm-5\"},[i(\"p\",{staticClass:\"mb-5\"},[t._v(\"Trạng thái:\\n                  \"),i(\"span\",{directives:[{name:\"status\",rawName:\"v-status:status\",value:t.ticket.status,expression:\"ticket.status\",arg:\"status\"}]},[t._v(\"\\n                    \"+t._s(t.ticket.status)+\"\\n                  \")])]),t.ticket.category?i(\"p\",{staticClass:\"mb-5\"},[t._v(\"Danh mục: \"+t._s(t.ticket.category))]):t._e()])]),i(\"hr\"),i(\"p\",{staticClass:\"text-pre-line\"},[t._v(t._s(t.ticket.content))]),t.attach_files&&t.attach_files.length?i(\"div\",{staticClass:\"gallery ticket-attach-files\"},[i(\"hr\"),i(\"div\",{staticClass:\"row\"},t._l(t.attach_files,(function(e,s){return i(\"div\",{key:s,staticClass:\"col\"},[t.isImage(e.url)?i(\"div\",{staticClass:\"gallery-item\",on:{click:function(i){return t.zoomImage(e.blob)}}},[i(\"img\",{staticClass:\"img-fluid w-full\",attrs:{src:e.blob}})]):i(\"div\",{staticClass:\"gallery-item ticket-file\"},[i(\"a\",{staticClass:\"btn\",on:{click:function(i){return t.getTicketFile(e,!0)}}},[i(\"span\",[t._v(t._s(t.extenionFileUrl(e)))]),i(\"span\",{staticClass:\"icon md-download\"})])])])})),0)]):t._e()])])]),t._l(t.messages,(function(e,s){return i(\"div\",{key:s,staticClass:\"card mb-5 ticket-message\",class:{me:e.user_id==t.auth.id}},[i(\"div\",{staticClass:\"card-block\"},[i(\"div\",{staticClass:\"card-title\"},[i(\"h4\",{staticClass:\"m0 d-ib\"},[t._v(\"\\n              \"+t._s(e.full_name||\"Undefined\")+\"\\n              \"),\"Y\"==e.is_staff?i(\"span\",{staticClass:\"badge badge-info text-top\"},[t._v(\"Lionnix Staff\")]):t._e()]),i(\"span\",{staticClass:\"float-right\"},[t._v(\"\\n              \"+t._s(t._f(\"datetime\")(e.created_at,\"dd/MM/yyyy HH:mm\"))+\"\\n            \")])]),i(\"div\",{staticClass:\"card-text\"},[i(\"p\",{staticClass:\"text-pre-line\"},[t._v(t._s(e.message))]),e.attach_files&&e.attach_files.length?i(\"div\",{staticClass:\"gallery ticket-attach-files\"},[i(\"hr\"),i(\"div\",{staticClass:\"row\"},t._l(e.attach_files,(function(e,s){return i(\"div\",{key:s,staticClass:\"col\"},[t.isImage(e.url)?i(\"div\",{staticClass:\"gallery-item\",on:{click:function(i){return t.zoomImage(e.blob)}}},[i(\"img\",{staticClass:\"img-fluid w-full\",attrs:{src:e.blob}})]):i(\"div\",{staticClass:\"gallery-item ticket-file\"},[i(\"a\",{staticClass:\"btn\",on:{click:function(i){return t.getTicketFile(e,!0)}}},[i(\"span\",[t._v(t._s(t.extenionFileUrl(e)))]),i(\"span\",{staticClass:\"icon md-download\"})])])])})),0)]):t._e()])])])})),i(\"div\",{staticClass:\"card\",attrs:{id:\"ticket-bottom\"}},[i(\"div\",{staticClass:\"card-block\"},[t.isHideReply?[i(\"div\",{staticClass:\"form-group floating\",class:[{\"has-success\":!t.errors.has(\"message\")},{\"has-danger\":t.errors.has(\"message\")}],attrs:{id:\"form-reply-ticket\"}},[i(\"textarea\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form.message,expression:\"form.message\"},{name:\"validate\",rawName:\"v-validate\",value:\"required\",expression:\"'required'\"}],staticClass:\"form-control\",attrs:{rows:\"5\",placeholder:\"Nội dung\",name:\"message\",\"data-vv-as\":\"Nội dung\"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,\"message\",e.target.value)}}}),t.errors.has(\"message\")?i(\"span\",{staticClass:\"invalid-feedback\"},[t._v(t._s(t.errors.first(\"message\")))]):t._e()]),i(\"div\",{staticClass:\"form-group floating\",class:[{\"has-success\":!t.errors.has(\"file\")},{\"has-danger\":t.errors.has(\"file\")}]},[t.files&&t.files.length?i(\"ul\",{staticClass:\"list-group list-group-full ticket-attach-list\"},t._l(t.files,(function(e,s){return i(\"li\",{key:s,staticClass:\"list-group-item\"},[i(\"span\",{staticClass:\"float-right\",on:{click:function(i){return i.preventDefault(),t.showDeleteConfirmation(e.uid)}}},[i(\"i\",{staticClass:\"icon md-close\"})]),t._v(\"\\n                  \"+t._s(e.name)+\"\\n                \")])})),0):t._e(),i(\"upload\",{staticClass:\"ticket-uploader\",attrs:{action:t.uploadFileEndpoint,accept:\".png,.jpg,.csv,.xlsx,.xls\",drag:\"\",multiple:\"\",\"list-type\":\"picture\",data:{type:\"tickets\"},headers:t.uploadHeaders,\"on-error\":t.handleErrorFile,\"on-success\":t.handleSuccess,\"max-file-size\":4e6}},[i(\"div\",{staticClass:\"el-upload__text\"},[i(\"p-icon\",{attrs:{name:\"image\",\"icon-pack\":\"md\"}}),t._v(\"\\n                  Tải file đính kèm\\n                \")],1)]),i(\"p\",[t._v(\"File đính kèm chỉ nhận định dạng PNG, JPEG, CSV, Excel và\\n                không được vượt quá 5MB\")])],1),i(\"p-button\",{attrs:{type:\"primary\",disable:t.isMessageSending},on:{click:t.handlerPushMessage}},[i(\"span\",[t._v(\"Trả lời\")])])]:[this.isClosed?i(\"p\",{staticClass:\"text-danger\"},[t._v(\"Ticket đã được đóng, nếu sự cố của bạn chưa được giải quết, bạn\\n              có thể bấm button dưới để mở lại ticket.\")]):t._e(),i(\"p-button\",{attrs:{id:\"btn-reopen\",type:\"primary\"},on:{click:function(e){t.isHideReply=!0}}},[i(\"span\",[t._v(\"Mở lại ticket\")])])]],2)])],2)]),i(\"modal-image\",{attrs:{visible:t.isZoomImage,src:t.imageZoomImage},on:{\"update:visible\":function(e){t.isZoomImage=e}}})],1)},r=[],n=i(\"a34a\"),a=i.n(n),c=i(\"2f62\"),o=i(\"3f86\"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"img-modal\",class:{active:t.isShow}},[i(\"span\",{staticClass:\"close\",on:{click:t.handleClose}},[t._v(\"×\")]),i(\"div\",{staticClass:\"modal-content\"},[i(\"img\",{staticClass:\"img\",attrs:{src:t.src}}),i(\"div\",{staticClass:\"caption\"})])])},u=[],h={name:\"ModalZoomImage\",props:{src:{type:String,default:\"\"},visible:{type:Boolean,default:!1}},data:function(){return{isShow:this.visible}},methods:{handleClose:function(){this.$emit(\"update:visible\",!1)}},watch:{visible:function(t){this.isShow=t}}},d=h,f=i(\"2877\"),p=Object(f[\"a\"])(d,l,u,!1,null,null,null),m=p.exports,g=i(\"73d7\"),v=i(\"7697\"),b=i(\"7f4f\"),y=i(\"45ba\");function _(t,e,i,s,r,n,a){try{var c=t[n](a),o=c.value}catch(l){return void i(l)}c.done?e(o):Promise.resolve(o).then(s,r)}function k(t){return function(){var e=this,i=arguments;return new Promise((function(s,r){var n=t.apply(e,i);function a(t){_(n,s,r,a,c,\"next\",t)}function c(t){_(n,s,r,a,c,\"throw\",t)}a(void 0)}))}}function w(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?w(Object(i),!0).forEach((function(e){C(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function C(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var O={name:\"TicketView\",mixins:[o[\"a\"],v[\"a\"],g[\"a\"]],components:{ModalImage:m},data:function(){return{isChange:!1,isHideReply:!0,isMessageSending:!1,isFetching:!1,imageZoomImage:\"\",isZoomImage:!1,result:{},filter:{page:1,limit:50},form:{ticket_id:0,message:\"\",urls:[]},attach_files:[]}},computed:x(x(x({},Object(c[\"d\"])(\"auth\",{auth:function(t){return t.user}})),Object(c[\"d\"])(\"ticket\",{ticket:function(t){return t.ticket},messages:function(t){return t.messages},count:function(t){return t.count}})),{},{createrName:function(){return this.ticket.creater?this.ticket.creater.ful_name||this.ticket.creater.username:\"Undefined\"},ticketID:function(){return parseInt(this.$route.params.id,10)},isClosed:function(){return\"closed\"===this.ticket.status}}),created:function(){this.filter=this.getRouteQuery(),this.init()},methods:x(x(x({},Object(c[\"b\"])(\"ticket\",[\"fetchTicket\",\"fetchTicketFile\",\"fetchTicketMessages\",\"pushMessage\",\"closeTicket\",\"fetchTicketStatictis\"])),Object(c[\"c\"])([\"updateTicketMessage\"])),{},{init:function(){var t=k(a.a.mark((function t(){return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([this.handlerFetchTicket(),this.handlerFetchTicketMessages()]);case 2:\"closed\"===this.ticket.status&&(this.isHideReply=!1),this.ticket.attach_files&&this.$set(this,\"attach_files\",Object(y[\"d\"])(this.ticket.attach_files)),this.getTicketFiles();case 5:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getTicketFile:function(){var t=k(a.a.mark((function t(e,i){var s,r;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isFetching=!0,t.prev=1,r={url:e,type:\"tickets\"},t.next=5,this.fetchTicketFile(r);case 5:if(s=t.sent,s.success){t.next=9;break}return this.$toast.open({type:\"error\",message:\"Download failed ! \"}),t.abrupt(\"return\",!1);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t[\"catch\"](1),this.$toast.open({type:\"error\",message:\"Download failed !\"});case 14:if(this.isFetching=!1,!i){t.next=19;break}b[\"a\"].downloadBlob(s.blob,e.split(\"/\").pop()),t.next=20;break;case 19:return t.abrupt(\"return\",window.URL.createObjectURL(s.blob));case 20:case\"end\":return t.stop()}}),t,this,[[1,11]])})));function e(e,i){return t.apply(this,arguments)}return e}(),getTicketFiles:function(){var t=this;if(!this.attach_files.length)return!1;this.attach_files.forEach(function(){var e=k(a.a.mark((function e(i,s){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.isImage(i)&&(r=t.getTicketFile(i,!1),r.then((function(e){t.$set(t.attach_files,s,{url:i,blob:e})})));case 1:case\"end\":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}())},handlerFetchTicket:function(){var t=k(a.a.mark((function t(){return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchTicket(this.ticketID);case 2:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handlerFetchTicketMessages:function(){var t=k(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isFetching=!0,t.next=3,this.fetchTicketMessages(this.ticketID,this.filter);case 3:this.messages.forEach((function(t,i){var s=t.attach_files;s&&s.forEach((function(t,s){if(e.isImage(t)){var r=e.getTicketFile(t,!1);r.then(function(e){this.messages[i].attach_files[s]={url:t,blob:e},this.$store.commit(\"ticket/updateTicketMessage\",Object(y[\"d\"])(this.messages))}.bind(e))}}))})),this.isFetching=!1;case 5:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handlerPushMessage:function(){var t=k(a.a.mark((function t(){var e,i;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.form.urls=this.files.map((function(t){return t.url})),t.next=3,this.$validator.validateAll();case 3:if(e=t.sent,e){t.next=6;break}return t.abrupt(\"return\");case 6:return this.form.ticket_id=this.ticketID,this.isMessageSending=!0,t.next=10,this.pushMessage(this.form);case 10:if(i=t.sent,!i||!i.success){t.next=21;break}if(this.handlerFetchTicketMessages(),\"closed\"!==this.ticket.status){t.next=17;break}return this.handlerFetchTicket(),t.next=17,this.fetchTicketStatictis();case 17:this.clearFrom(),this.$toast.open({type:\"success\",message:\"Gửi tin thành công\"}),t.next=22;break;case 21:this.$toast.open({type:\"error\",message:i.message});case 22:this.isMessageSending=!1;case 23:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),clearFrom:function(){this.files=[],this.form={ticket_id:0,message:\"\",urls:[]}},zoomImage:function(t){this.isZoomImage=!0,this.imageZoomImage=t},showDeleteConfirmation:function(t){var e=this;this.$dialog.confirm({title:\"Xác nhận xóa file đính kèm?\",message:\"Bạn có chắc chắn muốn xóa file đính kèm này?\",confirmText:\"Xóa\",onConfirm:function(){return e.handleDeleteImage(t)},type:\"danger\"})},handlerForword:function(t){var e=this,i=this.ticket.staffs.find((function(e){return e.staff_id==t.id}));i?this.$toast.open({type:\"warning\",message:\"Ticket đã được chuyển tiếp cho \".concat(t.full_name||t.username)}):this.$dialog.confirm({title:\"Chuyển tiếp ticket\",message:\"Bạn muốn chuyển tiếp ticket cho \".concat(t.full_name||t.username),confirmText:\"Xác nhận\",onConfirm:function(){e.handlerForward(\"\",t.id)},type:\"primary\"})}})},j=O,S=Object(f[\"a\"])(j,s,r,!1,null,null,null);e[\"default\"]=S.exports},\"3a40\":function(t,e,i){\"use strict\";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"ticket-page page\"},[t._m(0),i(\"div\",{staticClass:\"page-content container-fluid\"},[i(\"div\",{staticClass:\"row\"},[i(\"div\",{staticClass:\"col-xl-6\"},[i(\"div\",{staticClass:\"card\"},[i(\"div\",{staticClass:\"card-block\"},[i(\"div\",{staticClass:\"form-group floating\",class:[{\"has-success\":!t.errors.has(\"category\")},{\"has-danger\":t.errors.has(\"category\")}]},[i(\"label\",{attrs:{for:\"\"}},[t._v(\"Chọn danh mục:\")]),i(\"p-select\",{directives:[{name:\"validate\",rawName:\"v-validate\",value:\"required\",expression:\"'required'\"}],staticClass:\"floating\",attrs:{name:\"category\",\"data-vv-as\":\"Danh mục\"},model:{value:t.form.category,callback:function(e){t.$set(t.form,\"category\",e)},expression:\"form.category\"}},[i(\"option\",{attrs:{value:\"\"}},[t._v(\"Chọn danh mục\")]),t._l(t.categories,(function(e,s){return i(\"option\",{key:s,domProps:{value:e}},[t._v(t._s(e))])}))],2),t.errors.has(\"category\")?i(\"span\",{staticClass:\"invalid-feedback\"},[t._v(t._s(t.errors.first(\"category\")))]):t._e()],1),i(\"div\",{staticClass:\"form-group floating\",class:[{\"has-success\":!t.errors.has(\"object_id\")},{\"has-danger\":t.errors.has(\"object_id\")}]},[i(\"div\",{staticClass:\"row\"},[i(\"div\",{staticClass:\"col-6\"},[i(\"label\",{attrs:{for:\"\"}},[t._v(\"Chọn shop:\")]),i(\"p-select\",{staticClass:\"floating\",attrs:{name:\"shop\",\"data-vv-as\":\"Shop\"},model:{value:t.shopId,callback:function(e){t.shopId=e},expression:\"shopId\"}},[i(\"option\",{attrs:{value:\"0\"}},[t._v(\"-- Chọn một shop --\")]),t._l(t.shops,(function(e){return i(\"option\",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name)+\" - \"+t._s(e.domain))])}))],2)],1),i(\"div\",{staticClass:\"col-6\"},[i(\"label\",{attrs:{for:\"\"}},[t._v(\"Chọn mã đơn hàng:\")]),i(\"multiselect\",{directives:[{name:\"validate\",rawName:\"v-validate\",value:\"required\",expression:\"'required'\"}],staticClass:\"multiselect-custom is-fullwidth\",attrs:{\"data-vv-as\":\"Đơn hàng\",name:\"object_id\",options:t.items,placeholder:\"Chọn đơn hàng\",loading:t.isLoading,limit:t.limit,\"custom-label\":t.customLabel},on:{\"search-change\":t.handleSearchOrders,select:t.handleSelect,remove:t.handleRemove},model:{value:t.selected,callback:function(e){t.selected=e},expression:\"selected\"}})],1)]),t.errors.has(\"object_id\")?i(\"span\",{staticClass:\"invalid-feedback\"},[t._v(t._s(t.errors.first(\"object_id\")))]):t._e()]),i(\"div\",{staticClass:\"form-group floating\",class:[{\"has-success\":!t.errors.has(\"subject\")},{\"has-danger\":t.errors.has(\"subject\")}]},[i(\"label\",{attrs:{for:\"\"}},[t._v(\"Tiêu đề:\")]),i(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form.subject,expression:\"form.subject\"},{name:\"validate\",rawName:\"v-validate\",value:\"required\",expression:\"'required'\"}],staticClass:\"form-control\",attrs:{type:\"text\",placeholder:\"Tiêu đề  \",name:\"subject\",\"data-vv-as\":\"Tiêu đề\"},domProps:{value:t.form.subject},on:{input:function(e){e.target.composing||t.$set(t.form,\"subject\",e.target.value)}}}),t.errors.has(\"subject\")?i(\"span\",{staticClass:\"invalid-feedback\"},[t._v(\"\\n                \"+t._s(t.errors.first(\"subject\"))+\"\\n              \")]):t._e()]),i(\"div\",{staticClass:\"form-group floating\",class:[{\"has-success\":!t.errors.has(\"content\")},{\"has-danger\":t.errors.has(\"content\")}]},[i(\"label\",{attrs:{for:\"\"}},[t._v(\"Nội dung:\")]),i(\"textarea\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form.content,expression:\"form.content\"},{name:\"validate\",rawName:\"v-validate\",value:\"required\",expression:\"'required'\"}],staticClass:\"form-control\",attrs:{rows:\"5\",placeholder:\"Nội dung\",name:\"content\",\"data-vv-as\":\"Nội dung\"},domProps:{value:t.form.content},on:{input:function(e){e.target.composing||t.$set(t.form,\"content\",e.target.value)}}}),t.errors.has(\"content\")?i(\"span\",{staticClass:\"invalid-feedback\"},[t._v(\"\\n                \"+t._s(t.errors.first(\"content\"))+\"\\n              \")]):t._e()]),i(\"div\",{staticClass:\"form-group floating\",class:[{\"has-success\":!t.errors.has(\"file\")},{\"has-danger\":t.errors.has(\"file\")}]},[t.files&&t.files.length?i(\"ul\",{staticClass:\"list-group list-group-full ticket-attach-list\"},t._l(t.files,(function(e,s){return i(\"li\",{key:s,staticClass:\"list-group-item\"},[i(\"span\",{staticClass:\"float-right\",on:{click:function(i){return i.preventDefault(),t.showDeleteConfirmation(e.uid)}}},[i(\"i\",{staticClass:\"icon md-close\"})]),t._v(\"\\n                  \"+t._s(e.name)+\"\\n                \")])})),0):t._e(),i(\"upload\",{staticClass:\"ticket-uploader\",attrs:{action:t.uploadFileEndpoint,accept:\".png,.jpg,.csv,.xlsx,.xls\",drag:\"\",multiple:\"\",\"list-type\":\"picture\",data:{type:\"tickets\"},headers:t.uploadHeaders,\"on-error\":t.handleErrorFile,\"on-success\":t.handleSuccess,\"max-file-size\":4e6}},[i(\"div\",{staticClass:\"el-upload__text\"},[i(\"p-icon\",{attrs:{name:\"attachment-alt\",\"icon-pack\":\"md\"}}),t._v(\"\\n                  Tải file đính kèm\\n                \")],1)]),i(\"p\",[t._v(\"File đính kèm chỉ hỗ trợ định dạng PNG, JPEG, CSV, XLSX và\\n                không vượt quá 5MB\")])],1),i(\"p-button\",{attrs:{type:\"primary\",disable:t.isSubmiting},on:{click:t.handlerCreateTicket}},[i(\"span\",[t._v(\"Mở ticket\")])])],1)])])])])])},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"page-header\"},[i(\"h4\",{staticClass:\"page-title\"},[t._v(\"Tạo mới Ticket\")])])}],n=i(\"a34a\"),a=i.n(n),c=i(\"2f62\"),o=i(\"3f86\"),l=i(\"b047c\"),u=i.n(l),h=i(\"7697\"),d=i(\"73d7\");function f(t,e,i,s,r,n,a){try{var c=t[n](a),o=c.value}catch(l){return void i(l)}c.done?e(o):Promise.resolve(o).then(s,r)}function p(t){return function(){var e=this,i=arguments;return new Promise((function(s,r){var n=t.apply(e,i);function a(t){f(n,s,r,a,c,\"next\",t)}function c(t){f(n,s,r,a,c,\"throw\",t)}a(void 0)}))}}function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function g(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){v(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b={name:\"TicketForm\",mixins:[o[\"a\"],h[\"a\"],d[\"a\"]],data:function(){return{isChange:!1,selected:\"\",isSubmiting:!1,isLoading:!1,limit:10,shopId:0,result:{},form:{subject:\"\",content:\"\",category:\"\",object_id:0,urls:[]}}},mounted:function(){this.fetchCategories(),this.orders&&this.orders.length||this.handleSearchOrders()},computed:g(g(g(g({},Object(c[\"d\"])(\"container\",{orders:function(t){return t.orders}})),Object(c[\"d\"])(\"ticket\",{categories:function(t){return t.categories}})),Object(c[\"d\"])(\"shop\",{shops:function(t){return t.shops}})),{},{items:function(){var t=this.orders.map((function(t){return{id:t.id,text:t.ref_id}}));return t},isClosed:function(){return\"closed\"===this.ticket.status}}),methods:g(g(g({},Object(c[\"b\"])(\"ticket\",[\"createTicket\",\"fetchCategories\"])),Object(c[\"b\"])(\"container\",[\"fetchOrders\"])),{},{handleSearchOrders:u()(p(a.a.mark((function t(){var e,i,s=arguments;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=s.length>0&&void 0!==s[0]?s[0]:\"\",!(this.shopId<1)){t.next=3;break}return t.abrupt(\"return\");case 3:return this.isLoading=!0,t.next=6,this.fetchOrders({limit:this.limit,search:e,shop_id:this.shopId});case 6:if(i=t.sent,this.isLoading=!1,!i||!i.success){t.next=10;break}return t.abrupt(\"return\");case 10:this.$toast.open({type:\"error\",message:i.message});case 11:case\"end\":return t.stop()}}),t,this)}))),500),handlerCreateTicket:function(){var t=p(a.a.mark((function t(){var e,i;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.form.urls=this.files.map((function(t){return t.url})),t.next=3,this.$validator.validateAll();case 3:if(e=t.sent,e){t.next=6;break}return t.abrupt(\"return\");case 6:return t.next=8,this.createTicket(this.form);case 8:i=t.sent,i.success?(this.clearFrom(),this.$router.push({name:\"ticket-view\",params:{id:i.id}})):this.$toast.open({type:\"error\",message:i.message});case 10:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),customLabel:function(t){var e=t.text;return\"undefined\"!==typeof e?\"\".concat(e):\"\"},handleSelect:function(t){this.form.object_id=t&&t.id?t.id:0},handleRemove:function(){this.form.object_id=0},clearFrom:function(){this.files=[],this.form={subject:\"\",content:\"\",category:\"\",object_id:0,urls:null}},showDeleteConfirmation:function(t){var e=this;this.$dialog.confirm({title:\"Xác nhận xóa file đính kèm?\",message:\"Bạn có chắc chắn muốn xóa file đính kèm này?\",confirmText:\"Xóa\",onConfirm:function(){return e.handleDeleteImage(t)},type:\"danger\"})}}),watch:{shopId:function(){this.handleSearchOrders()}}},y=b,_=i(\"2877\"),k=Object(_[\"a\"])(y,s,r,!1,null,null,null);e[\"default\"]=k.exports},\"3f86\":function(t,e,i){\"use strict\";var s=i(\"45ba\"),r=i(\"54d7\");function n(t){return n=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t},n(t)}e[\"a\"]={data:function(){return{filter:{}}},methods:{toBack:function(){return this.$router.go(-1)},getRouteQuery:function(){var t=this,e={};Object.keys(this.filter).forEach((function(i){if(\"undefined\"!==typeof t.$route.query[i]){var s=t.$route.query[i];switch(n(t.filter[i])){case\"number\":s=Number(s);break;case\"boolean\":s=!!s;break}e[i]=s}else e[i]=t.filter[i]}));var i=r[\"d\"];return e.limit=e.limit<=i?e.limit:i,Object.assign({},this.$route.query,e)},handleUpdateRouteQuery:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(s[\"d\"])(this.$route.query);e=Object.assign(e,this.filter,t),e.page||(e.page=1);var i={};for(var r in e)e.hasOwnProperty(r)&&e[r]&&(i[r]=e[r]);this.$router.push({query:i,path:this.$route.path}).catch((function(){}))}},watch:{$route:function(){var t=this.getRouteQuery();Object(s[\"f\"])(t,this.filter)&&(this.filter=t)}}}},\"68ee\":function(t,e,i){!function(e,i){t.exports=i()}(\"undefined\"!=typeof self&&self,(function(){return function(t){function e(s){if(i[s])return i[s].exports;var r=i[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,\"a\",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=11)}([function(t,e){t.exports=function(t,e,i,s,r,n){var a,c=t=t||{},o=typeof t.default;\"object\"!==o&&\"function\"!==o||(a=t,c=t.default);var l,u=\"function\"==typeof c?c.options:c;if(e&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0),i&&(u.functional=!0),r&&(u._scopeId=r),n?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},u._ssrRegister=l):s&&(l=s),l){var h=u.functional,d=h?u.render:u.beforeCreate;h?(u._injectStyles=l,u.render=function(t,e){return l.call(e),d(t,e)}):u.beforeCreate=d?[].concat(d,l):[l]}return{esModule:a,exports:c,options:u}}},function(t,e,i){\"use strict\";var s=i(2),r=i(12),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(t){return/^#([A-Fa-f0-9]{3}|[A-Fa-f0-9]{6})$/.test(t)};e.a={name:\"VueContentLoading\",props:{rtl:{default:!1,type:Boolean},speed:{default:2,type:Number},width:{default:400,type:Number},height:{default:130,type:Number},primary:{type:String,default:\"#f0f0f0\",validator:s},secondary:{type:String,default:\"#e0e0e0\",validator:s}},computed:{viewbox:function(){return\"0 0 \"+this.width+\" \"+this.height},formatedSpeed:function(){return this.speed+\"s\"},gradientId:function(){return\"gradient-\"+this._uid},clipPathId:function(){return\"clipPath-\"+this._uid},svg:function(){if(this.rtl)return{transform:\"rotateY(180deg)\"}},rect:function(){return{style:{fill:\"url(#\"+this.gradientId+\")\"},clipPath:\"url(#\"+this.clipPathId+\")\"}}}}},function(t,e,i){\"use strict\";var s=i(1);e.a={components:{VueContentLoading:s.a}}},function(t,e,i){\"use strict\";var s=i(1);e.a={components:{VueContentLoading:s.a}}},function(t,e,i){\"use strict\";var s=i(1);e.a={components:{VueContentLoading:s.a}}},function(t,e,i){\"use strict\";var s=i(1);e.a={components:{VueContentLoading:s.a}}},function(t,e,i){\"use strict\";var s=i(1);e.a={components:{VueContentLoading:s.a}}},function(t,e,i){\"use strict\";var s=i(1);e.a={components:{VueContentLoading:s.a},props:{rows:{default:5,type:Number}},computed:{height:function(){return 21*this.rows}},methods:{getYPos:function(t,e){return e+22*(t-1)}}}},function(t,e,i){\"use strict\";var s=i(1);e.a={components:{VueContentLoading:s.a},props:{header:{default:!0,type:Boolean},rows:{default:5,type:Number},columns:{default:4,type:Number}},computed:{height:function(){return 30*this.rows-20},width:function(){return 20*(this.columns-1)+10+100*this.columns}},methods:{getXPos:function(t){return 5+100*(t-1)+20*(t-1)},getYPos:function(t){return 30*(t-1)}}}},,function(t,e,i){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var s=i(1),r=i(13),n=i(15),a=i(17),c=i(19),o=i(21),l=i(23),u=i(25);i.d(e,\"VclCode\",(function(){return r.a})),i.d(e,\"VclList\",(function(){return n.a})),i.d(e,\"VclTwitch\",(function(){return a.a})),i.d(e,\"VclFacebook\",(function(){return c.a})),i.d(e,\"VclInstagram\",(function(){return o.a})),i.d(e,\"VclBulletList\",(function(){return l.a})),i.d(e,\"VclTable\",(function(){return u.a})),i.d(e,\"VueContentLoading\",(function(){return s.a})),e.default=s.a},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"svg\",{style:t.svg,attrs:{viewBox:t.viewbox,preserveAspectRatio:\"xMidYMid meet\"}},[i(\"rect\",{style:t.rect.style,attrs:{\"clip-path\":t.rect.clipPath,x:\"0\",y:\"0\",width:t.width,height:t.height}}),t._v(\" \"),i(\"defs\",[i(\"clipPath\",{attrs:{id:t.clipPathId}},[t._t(\"default\",[i(\"rect\",{attrs:{x:\"0\",y:\"0\",rx:\"5\",ry:\"5\",width:\"70\",height:\"70\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"80\",y:\"17\",rx:\"4\",ry:\"4\",width:\"300\",height:\"13\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"80\",y:\"40\",rx:\"3\",ry:\"3\",width:\"250\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"80\",rx:\"3\",ry:\"3\",width:\"350\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"100\",rx:\"3\",ry:\"3\",width:\"400\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"120\",rx:\"3\",ry:\"3\",width:\"360\",height:\"10\"}})])],2),t._v(\" \"),i(\"linearGradient\",{attrs:{id:t.gradientId}},[i(\"stop\",{attrs:{offset:\"0%\",\"stop-color\":t.primary}},[i(\"animate\",{attrs:{attributeName:\"offset\",values:\"-2; 1\",dur:t.formatedSpeed,repeatCount:\"indefinite\"}})]),t._v(\" \"),i(\"stop\",{attrs:{offset:\"50%\",\"stop-color\":t.secondary}},[i(\"animate\",{attrs:{attributeName:\"offset\",values:\"-1.5; 1.5\",dur:t.formatedSpeed,repeatCount:\"indefinite\"}})]),t._v(\" \"),i(\"stop\",{attrs:{offset:\"100%\",\"stop-color\":t.primary}},[i(\"animate\",{attrs:{attributeName:\"offset\",values:\"-1; 2\",dur:t.formatedSpeed,repeatCount:\"indefinite\"}})])],1)],1)])},r=[],n={render:s,staticRenderFns:r};e.a=n},function(t,e,i){\"use strict\";var s=i(3),r=i(14),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"vue-content-loading\",t._b({attrs:{width:300,height:80}},\"vue-content-loading\",t.$attrs,!1),[i(\"rect\",{attrs:{x:\"0\",y:\"0\",rx:\"3\",ry:\"3\",width:\"70\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"80\",y:\"0\",rx:\"3\",ry:\"3\",width:\"100\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"190\",y:\"0\",rx:\"3\",ry:\"3\",width:\"10\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"15\",y:\"20\",rx:\"3\",ry:\"3\",width:\"130\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"155\",y:\"20\",rx:\"3\",ry:\"3\",width:\"130\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"15\",y:\"40\",rx:\"3\",ry:\"3\",width:\"90\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"115\",y:\"40\",rx:\"3\",ry:\"3\",width:\"60\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"185\",y:\"40\",rx:\"3\",ry:\"3\",width:\"60\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"60\",rx:\"3\",ry:\"3\",width:\"30\",height:\"10\"}})])},r=[],n={render:s,staticRenderFns:r};e.a=n},function(t,e,i){\"use strict\";var s=i(4),r=i(16),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"vue-content-loading\",t._b({attrs:{width:300,height:120}},\"vue-content-loading\",t.$attrs,!1),[i(\"rect\",{attrs:{x:\"0\",y:\"0\",rx:\"3\",ry:\"3\",width:\"250\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"20\",y:\"20\",rx:\"3\",ry:\"3\",width:\"220\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"20\",y:\"40\",rx:\"3\",ry:\"3\",width:\"170\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"60\",rx:\"3\",ry:\"3\",width:\"250\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"20\",y:\"80\",rx:\"3\",ry:\"3\",width:\"200\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"20\",y:\"100\",rx:\"3\",ry:\"3\",width:\"80\",height:\"10\"}})])},r=[],n={render:s,staticRenderFns:r};e.a=n},function(t,e,i){\"use strict\";var s=i(5),r=i(18),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"vue-content-loading\",t._b({attrs:{width:300,height:225}},\"vue-content-loading\",t.$attrs,!1),[i(\"rect\",{attrs:{x:\"0\",y:\"0\",rx:\"3\",ry:\"3\",width:\"300\",height:\"170\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"180\",rx:\"2\",ry:\"2\",width:\"35\",height:\"45\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"45\",y:\"180\",rx:\"2\",ry:\"2\",width:\"150\",height:\"15\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"45\",y:\"203\",rx:\"2\",ry:\"2\",width:\"100\",height:\"10\"}})])},r=[],n={render:s,staticRenderFns:r};e.a=n},function(t,e,i){\"use strict\";var s=i(6),r=i(20),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"vue-content-loading\",t._b({},\"vue-content-loading\",t.$attrs,!1),[i(\"rect\",{attrs:{x:\"0\",y:\"0\",rx:\"5\",ry:\"5\",width:\"70\",height:\"70\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"80\",y:\"17\",rx:\"4\",ry:\"4\",width:\"300\",height:\"13\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"80\",y:\"40\",rx:\"3\",ry:\"3\",width:\"250\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"80\",rx:\"3\",ry:\"3\",width:\"350\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"100\",rx:\"3\",ry:\"3\",width:\"400\",height:\"10\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"120\",rx:\"3\",ry:\"3\",width:\"360\",height:\"10\"}})])},r=[],n={render:s,staticRenderFns:r};e.a=n},function(t,e,i){\"use strict\";var s=i(7),r=i(22),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"vue-content-loading\",t._b({attrs:{height:480}},\"vue-content-loading\",t.$attrs,!1),[i(\"circle\",{attrs:{cx:\"30\",cy:\"30\",r:\"30\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"75\",y:\"13\",rx:\"4\",ry:\"4\",width:\"100\",height:\"13\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"75\",y:\"37\",rx:\"4\",ry:\"4\",width:\"50\",height:\"8\"}}),t._v(\" \"),i(\"rect\",{attrs:{x:\"0\",y:\"70\",rx:\"5\",ry:\"5\",width:\"400\",height:\"400\"}})])},r=[],n={render:s,staticRenderFns:r};e.a=n},function(t,e,i){\"use strict\";var s=i(8),r=i(24),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"vue-content-loading\",t._b({attrs:{width:230,height:t.height}},\"vue-content-loading\",t.$attrs,!1),[t._l(t.rows,(function(e){return[i(\"circle\",{key:e+\"_c\",attrs:{cx:\"8\",cy:t.getYPos(e,8),r:\"8\"}}),t._v(\" \"),i(\"rect\",{key:e+\"_r\",attrs:{x:\"22\",y:t.getYPos(e,3),rx:\"3\",ry:\"3\",width:\"200\",height:\"9\"}})]}))],2)},r=[],n={render:s,staticRenderFns:r};e.a=n},function(t,e,i){\"use strict\";var s=i(9),r=i(26),n=i(0),a=n(s.a,r.a,!1,null,null,null);e.a=a.exports},function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"vue-content-loading\",t._b({attrs:{width:t.width,height:t.height}},\"vue-content-loading\",t.$attrs,!1),[t._l(t.rows,(function(e){return[t._l(t.columns,(function(s){return[i(\"rect\",{key:e+\"_\"+s,attrs:{x:t.getXPos(s),y:t.getYPos(e),rx:\"3\",ry:\"3\",width:100,height:\"10\"}})]})),t._v(\" \"),e<t.rows?i(\"rect\",{key:e+\"_l\",attrs:{x:\"0\",y:t.getYPos(e)+20,width:t.width,height:\"1\"}}):t._e()]}))],2)},r=[],n={render:s,staticRenderFns:r};e.a=n}])}))},\"73d7\":function(t,e,i){\"use strict\";var s=i(\"5281\"),r=i(\"7f4f\");e[\"a\"]={components:{Upload:s[\"b\"]},data:function(){return{files:[]}},filter:{},methods:{extenionFileUrl:function(t){var e=/(?:\\.([^.]+))?$/,i=e.exec(t)[1];return void 0===i?\"\":i},isImage:function(t){var e=this.extenionFileUrl(t);return-1!==[\"png\",\"jpg\"].indexOf(e)},download:function(t){r[\"a\"].download(t)},handleSuccess:function(t,e){t&&\"undefined\"!==typeof t.urls&&this.files.push({url:t.urls[0],uid:e.uid,name:e.name})},handleErrorFile:function(){},handleDeleteImage:function(t){this.files=this.files.filter((function(e){return e.uid!=t}))}}}},7697:function(t,e,i){\"use strict\";var s=i(\"0681\");e[\"a\"]={computed:{uploadHeaders:function(){return{Authorization:\"Bearer \".concat(s[\"a\"].getAccessToken())}},uploadEndpoint:function(){return\"\".concat(\"https://api-stag.lionnix.com/v1\",\"/uploads/images\")},uploadFileEndpoint:function(){return\"\".concat(\"https://api-stag.lionnix.com/v1\",\"/uploads/files\")}},methods:{createEndpoint:function(t){return\"\".concat(\"https://api-stag.lionnix.com/v1\",\"/\").concat(t)}}}},\"808f\":function(t,e,i){\"use strict\";var s=i(\"45ba\");e[\"a\"]={computed:{totalSelected:function(){return this.action&&this.action.selected?this.action.selected.length:0},paginationLabel:function(){var t=this.filter.page?this.filter.page:0,e=(t-1)*this.filter.limit||1,i=Math.ceil(this.count/this.filter.limit);if(i<this.filter.page||!e)return\"\";var s=this.count>=this.filter.limit?t*this.filter.limit:this.count;return s>this.count&&(s=this.count),s>e?\"Hiển thị \".concat(e,\"-\").concat(s,\" trong tổng \").concat(this.count,\" kết quả\"):\"\"},selectedIds:function(){return this.action&&this.action.selected&&this.action.selected.length?this.action.selected.map((function(t){var e=t.id;return e})):[]},items:function(){return[]},isAllChecked:function(){return this.action.selected&&this.items.length===this.action.selected.length&&this.totalSelected>0},isIndeterminate:function(){return!!this.action.selected&&(this.action.selected.length>0&&this.action.selected.length<this.items.length)},selectionCountText:function(){return\"\".concat(this.totalSelected,\" đơn hàng đã được chọn\")}},data:function(){return{filter:{page:1,limit:20,search:\"\"},action:{current:\"\",selected:[],visibleConfirm:!1},actions:{}}},methods:{onMultipleSelect:function(t){this.$set(this.action,\"selected\",t)},handleActionItem:function(){},handleAction:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.action.current=t,this.action.item=i,this.actions&&this.actions[t]&&this.actions[t].isNeedConfirm?this.$dialog.confirm({title:\"Are you sure you want to do this?\",onConfirm:function(){return e.handleActionItem()}}):this.handleActionItem()},handleSearch:function(t){this.filter.page=1,this.$set(this.filter,\"search\",t.target.value)},clearSearch:function(){this.$set(this.filter,\"search\",\"\")},onActionConfirm:function(){this.handleActionItem()},toggleSelectAll:function(){var t=[];t=this.isAllChecked?[]:Object(s[\"d\"])(this.items),this.$set(this.action,\"selected\",t)}},watch:{$route:function(){this.action.selected&&this.$set(this.action,\"selected\",[])}}}},\"8a77\":function(t,e,i){\"use strict\";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"ticket-page page\"},[i(\"div\",{staticClass:\"page-content container-fluid\"},[i(\"div\",{staticClass:\"row\"},[i(\"div\",{staticClass:\"col-xl-3\"},[i(\"div\",{staticClass:\"d-flex mb-2 justify-content-between tal\"},[i(\"router-link\",{staticClass:\"col-6 btn btn-primary\",attrs:{to:{name:\"ticket-form\"}}},[i(\"p-icon\",{attrs:{name:\"envelope\"}}),i(\"span\",{staticClass:\"ml-5\"},[t._v(\"Mở ticket\")])],1),i(\"a\",{staticClass:\"col-5 btn btn-default bg-white btn-outline\",on:{click:t.refresh}},[i(\"p-icon\",{class:{\"animation-rotate\":t.isLoading},attrs:{\"icon-pack\":\"md\",name:\"refresh\"}}),i(\"span\",{staticClass:\"ml-5\"},[t._v(\"Refresh\")])],1)],1),i(\"Sidebar\")],1),i(\"div\",{staticClass:\"col-xl-9\"},[i(\"router-view\",{key:t.$route.name})],1)])])])},r=[],n=i(\"a34a\"),a=i.n(n),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"treeview\"},[i(\"ul\",{staticClass:\"list-group\"},[i(\"li\",{staticClass:\"pt-25 list-group-item\",class:{current:\"open\"==t.status}},[i(\"span\",{staticClass:\"icon node-icon wb-inbox\"}),i(\"a\",{attrs:{href:\"#\"},on:{click:function(e){return t.onChangeStatus(\"open\")}}},[i(\"strong\",[t._v(\"Mới\")])]),i(\"span\",{staticClass:\"node-count\"},[t._v(t._s(t.statisticTickets.open?t.statisticTickets.open.total:0))])]),i(\"li\",{staticClass:\"list-group-item\",class:{current:\"process\"==t.status}},[i(\"span\",{staticClass:\"icon node-icon wb-chat-working\"}),i(\"a\",{attrs:{href:\"#\"},on:{click:function(e){return t.onChangeStatus(\"process\")}}},[i(\"strong\",[t._v(\"Đang xử lý\")])]),i(\"span\",{staticClass:\"node-count\"},[t._v(t._s(t.statisticTickets.process?t.statisticTickets.process.total:0))])]),i(\"li\",{staticClass:\"pb-25 list-group-item\",class:{current:\"closed\"==t.status}},[i(\"span\",{staticClass:\"icon node-icon wb-check-circle\"}),i(\"a\",{attrs:{href:\"#\"},on:{click:function(e){return t.onChangeStatus(\"closed\")}}},[i(\"strong\",[t._v(\"Đã hoàn thành\")])]),i(\"span\",{staticClass:\"node-count\"},[t._v(t._s(t.statisticTickets.closed?t.statisticTickets.closed.total:0))])])])])},o=[],l=i(\"3f86\"),u=i(\"2f62\");function h(t,e,i,s,r,n,a){try{var c=t[n](a),o=c.value}catch(l){return void i(l)}c.done?e(o):Promise.resolve(o).then(s,r)}function d(t){return function(){var e=this,i=arguments;return new Promise((function(s,r){var n=t.apply(e,i);function a(t){h(n,s,r,a,c,\"next\",t)}function c(t){h(n,s,r,a,c,\"throw\",t)}a(void 0)}))}}function f(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?f(Object(i),!0).forEach((function(e){m(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var g={name:\"TicketSidebar\",mixins:[l[\"a\"]],data:function(){return{status:\"\",highlight:\"\"}},mounted:function(){this.init()},computed:p({},Object(u[\"d\"])(\"ticket\",{statisticTickets:function(t){return t.statisticTickets}})),methods:p(p({},Object(u[\"b\"])(\"ticket\",[\"fetchTicketStatictis\"])),{},{init:function(){var t=d(a.a.mark((function t(){var e;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$route.query,\"undefined\"!==typeof e.status&&(this.status=e.status),t.next=4,this.fetchTicketStatictis();case 4:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onChangeStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\";this.status=t,this.highlight=\"\",this.$router.push({name:\"ticket-list\",query:{status:this.status,highlight:this.highlight}})},onChangeHighlight:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\";this.highlight=t,this.status=\"process\",this.$router.push({name:\"ticket-list\",query:{status:this.status,highlight:this.highlight}})}})},v=g,b=i(\"2877\"),y=Object(b[\"a\"])(v,c,o,!1,null,null,null),_=y.exports;function k(t,e,i,s,r,n,a){try{var c=t[n](a),o=c.value}catch(l){return void i(l)}c.done?e(o):Promise.resolve(o).then(s,r)}function w(t){return function(){var e=this,i=arguments;return new Promise((function(s,r){var n=t.apply(e,i);function a(t){k(n,s,r,a,c,\"next\",t)}function c(t){k(n,s,r,a,c,\"throw\",t)}a(void 0)}))}}function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function C(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){O(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function O(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var j={name:\"TicketLayout\",mixins:[l[\"a\"]],components:{Sidebar:_},data:function(){return{isLoading:!1}},computed:{ticketID:function(){return parseInt(this.$route.params.id,10)}},methods:C(C({},Object(u[\"b\"])(\"ticket\",[\"fetchTicketStatictis\",\"fetchTickets\",\"fetchTicket\"])),{},{refresh:function(){var t=w(a.a.mark((function t(){var e,i=this;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.next=3,this.fetchTicketStatictis();case 3:if(!this.ticketID){t.next=8;break}return t.next=6,this.fetchTicket(this.ticketID);case 6:t.next=11;break;case 8:return e=this.getRouteQuery(),t.next=11,this.fetchTickets(e);case 11:setTimeout((function(){i.isLoading=!1}),1e3);case 12:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handlerCreateTicket:function(){this.$router.push({name:\"ticket-form\"})}})},S=j,P=Object(b[\"a\"])(S,s,r,!1,null,null,null);e[\"default\"]=P.exports},dabd:function(t,e,i){\"use strict\";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",[i(\"p-input\",{staticClass:\"mb-2 taf\",attrs:{placeholder:\"Tìm kiếm ticket theo Mã đơn hàng/Tiêu đề\",prefixIcon:\"search\",type:\"search\",value:t.filter.search},on:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.handleSearch(e)}}},[i(\"template\",{slot:\"append\"},[t.filter.search?i(\"p-button\",{attrs:{type:\"default\",icon:\"close\"},on:{click:t.clearSearch}}):t._e(),i(\"p-button\",{attrs:{slot:\"trigger\",type:\"default\"},on:{click:t.handlerShowModalFilter},slot:\"trigger\"},[i(\"span\",{staticClass:\"mr-10\"},[t._v(\"Lọc nâng cao\")])]),i(\"p-dropdown\",{staticClass:\"ml-20\",attrs:{\"dropdown-class\":\"dropdown-menu-right\"}},[i(\"p-button\",{attrs:{slot:\"trigger\",type:\"dark\"},slot:\"trigger\"},[i(\"span\",{staticClass:\"mr-10\"},[t._v(\"Sắp xếp\")]),i(\"p-icon\",{attrs:{\"icon-pack\":\"md\",name:\"swap-vertical\"}})],1),[i(\"p-dropdown-item\",{on:{click:function(e){return t.onSort(\"created_at:desc\")}}},[t._v(\"Ngày tạo mới nhất\")]),i(\"p-dropdown-item\",{on:{click:function(e){return t.onSort(\"created_at:asc\")}}},[t._v(\"Ngày tạo cũ nhất\")]),i(\"p-dropdown-item\",{on:{click:function(e){return t.onSort(\"updated_at:desc\")}}},[t._v(\"Ngày trả lời mới nhất\")]),i(\"p-dropdown-item\",{on:{click:function(e){return t.onSort(\"updated_at:asc\")}}},[t._v(\"Ngày trả lời cũ nhất\")])]],2)],1)],2),i(\"div\",{staticClass:\"card\"},[i(\"div\",{staticClass:\"card-body\"},[i(\"div\",{staticClass:\"d-filters\"},t._l(t.filter,(function(e,s){return e&&-1!==t.filterKeyShow.indexOf(s)?i(\"div\",{key:s,staticClass:\"badge badge-lg badge-outline badge-dark\"},[i(\"span\",[t._v(t._s(t._f(\"textKeyFilter\")(s))+\": \"+t._s(e))]),i(\"a\",{attrs:{href:\"#\"},on:{click:function(e){t.filter[s]=\"\"}}},[i(\"p-icon\",{attrs:{name:\"close-mini\"}})],1)]):t._e()})),0),t.isFetching?i(\"VclTable\",{staticClass:\"my-20\"}):t.tickets.length?[i(\"div\",{staticClass:\"table-responsive-xl\"},[i(\"table\",{staticClass:\"table table-hover table-border\"},[i(\"thead\",[i(\"tr\",[i(\"th\",{attrs:{width:\"50\"}},[t._v(\"ID\")]),i(\"th\",[t._v(\"Tiêu đề\")]),i(\"th\",[t._v(\"Mã đơn hàng\")]),i(\"th\",{staticClass:\"text-right\"},[t._v(\"Ngày tạo\")])])]),i(\"tbody\",t._l(t.tickets,(function(e,s){return i(\"tr\",{key:s},[i(\"td\",[t._v(t._s(e.id))]),i(\"td\",[i(\"router-link\",{staticClass:\"text-no-underline\",attrs:{slot:\"reference\",to:{name:\"ticket-view\",params:{id:e.id}}},slot:\"reference\"},[i(\"strong\",[t._v(t._s(t.truncate(e.subject,50)))])])],1),i(\"td\",[t._v(t._s(e.ref_id))]),i(\"td\",{staticClass:\"text-right\"},[t._v(t._s(t._f(\"datetime\")(e.created_at,\"dd/MM/yyyy HH:mm\")))])])})),0)])]),i(\"div\",{staticClass:\"d-flex justify-content-between align-items-center\"},[i(\"span\",[t._v(t._s(t.paginationLabel))]),i(\"p-pagination\",{attrs:{total:t.count,perPage:t.filter.limit,current:t.filter.page,size:\"sm\"},on:{\"update:current\":function(e){return t.$set(t.filter,\"page\",e)}}})],1)]:i(\"EmptySearchResult\",{attrs:{title:\"Không tìm thấy ticket\"}})],2)]),i(\"modal-filter\",{attrs:{visible:t.showModalFilter,categories:t.categories},on:{\"update:visible\":function(e){t.showModalFilter=e},update:t.handlerFilterAdvanced}})],1)},r=[],n=i(\"a34a\"),a=i.n(n),c=i(\"2f62\"),o=i(\"fc25\"),l=i(\"b047c\"),u=i.n(l),h=i(\"3f86\"),d=i(\"808f\"),f=i(\"68ee\"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"p-modal\",{class:\"ticket-filter\",attrs:{size:\"md\",active:t.isShow,title:\"Bộ lọc nâng cao\"},on:{\"update:active\":function(e){t.isShow=e},close:t.handleClose}},[i(\"div\",{staticClass:\"form-group row\"},[i(\"label\",{staticClass:\"col-sm-3\"},[t._v(\"Ngày: \")]),i(\"div\",{staticClass:\"col-sm-9\"},[i(\"p-datepicker\",{attrs:{format:\"dd/mm/yyyy\"},on:{update:t.selectDate},model:{value:t.filter.start_date,callback:function(e){t.$set(t.filter,\"start_date\",e)},expression:\"filter.start_date\"}})],1)]),i(\"div\",{staticClass:\"form-group row\"},[i(\"label\",{staticClass:\"col-sm-3\"},[t._v(\"Danh mục:\")]),i(\"div\",{staticClass:\"col-sm-9\"},[i(\"select\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.filter.category,expression:\"filter.category\"}],staticClass:\"form-control\",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e=\"_value\"in t?t._value:t.value;return e}));t.$set(t.filter,\"category\",e.target.multiple?i:i[0])}}},[i(\"option\",{attrs:{value:\"\",disabled:\"\"}},[t._v(\"-- Chọn danh mục --\")]),t._l(t.categories,(function(e,s){return i(\"option\",{key:s,domProps:{value:e}},[t._v(t._s(e))])}))],2)])]),i(\"template\",{slot:\"footer\"},[i(\"p-button\",{attrs:{type:\"default\"},on:{click:t.handleClose}},[i(\"span\",[t._v(\"Đóng\")])]),i(\"p-button\",{attrs:{type:\"primary\"},on:{click:t.handleFilter}},[i(\"span\",[t._v(\"Lọc\")])])],1)],2)},m=[],g=i(\"08ba\"),v={name:\"ModalTicketFilter\",props:{categories:{type:Array,default:function(){return[]}},src:{type:String,default:\"\"},visible:{type:Boolean,default:!1}},data:function(){return{isShow:this.visible,cb_accountant:[],filter:{category:\"\",start_date:\"\",end_date:\"\",seller:0,support:0,accountant:\"\"}}},methods:{handleClose:function(){this.$emit(\"update:visible\",!1)},handleFilter:function(){this.$emit(\"update\",this.filter)},selectDate:function(t){this.filter.start_date=Object(g[\"a\"])(t.startDate,\"yyyy-MM-dd\"),this.filter.end_date=Object(g[\"a\"])(t.endDate,\"yyyy-MM-dd\")}},watch:{visible:function(t){this.isShow=t}}},b=v,y=i(\"2877\"),_=Object(y[\"a\"])(b,p,m,!1,null,null,null),k=_.exports,w=i(\"f88f\");function x(t,e,i,s,r,n,a){try{var c=t[n](a),o=c.value}catch(l){return void i(l)}c.done?e(o):Promise.resolve(o).then(s,r)}function C(t){return function(){var e=this,i=arguments;return new Promise((function(s,r){var n=t.apply(e,i);function a(t){x(n,s,r,a,c,\"next\",t)}function c(t){x(n,s,r,a,c,\"throw\",t)}a(void 0)}))}}function O(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?O(Object(i),!0).forEach((function(e){S(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function S(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var P={name:\"TicketList\",mixins:[h[\"a\"],d[\"a\"]],components:{EmptySearchResult:o[\"a\"],VclTable:f[\"VclTable\"],ModalFilter:k},data:function(){return{showModalFilter:!1,isFetching:!1,result:{},filterKeyShow:[\"support\",\"search\",\"category\",\"seller\",\"accountant\",\"start_date\",\"end_date\",\"sort\"],filter:{page:1,search:\"\",sort:\"\",limit:50}}},filters:{textKeyFilter:function(t){return t.replace(\"_\",\" \")}},computed:j(j({},Object(c[\"d\"])(\"ticket\",{tickets:function(t){return t.tickets},count:function(t){return t.count},categories:function(t){return t.categories}})),{},{ticketStatus:function(){return[\"open\",\"process\",\"close\"]}}),created:function(){this.filter=this.getRouteQuery()},methods:j(j({truncate:w[\"c\"]},Object(c[\"b\"])(\"ticket\",[\"fetchTickets\",\"fetchCategories\"])),{},{init:function(){var t=C(a.a.mark((function t(){return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isFetching=!0,this.handleUpdateRouteQuery(),t.next=4,this.fetchTickets(this.filter);case 4:return this.result=t.sent,t.next=7,this.fetchCategories();case 7:this.isFetching=!1;case 8:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleSearch:u()((function(t){this.filter.search=t.target.value}),500),handlerCreateTicket:function(){this.$router.push({name:\"ticket-form\"})},onSort:function(t){this.filter.sort=t},handlerShowModalFilter:function(){this.showModalFilter=!0},handlerFilterAdvanced:function(t){this.filter=Object.assign(this.filter,t),this.init(),this.showModalFilter=!1}}),watch:{filter:{handler:function(){this.init()},deep:!0}}},T=P,$=Object(y[\"a\"])(T,s,r,!1,null,null,null);e[\"default\"]=$.exports},fc25:function(t,e,i){\"use strict\";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"empty-search-result\"},[i(\"img\",{staticClass:\"empty-search-result__image\",attrs:{src:t.notFoundImage,alt:\"Empty search results\"}}),t.title?i(\"p\",{staticClass:\"empty-search-result__title\"},[t._v(t._s(t.title))]):t._e(),t.subtitle?i(\"p\",{staticClass:\"empty-search-result__subtitle\"},[t._v(t._s(t.subtitle))]):t._e()])},r=[],n={name:\"EmptySearchResult\",props:{title:{type:String,default:\"\"},subtitle:{type:String,default:\"Thay đổi bộ lọc hoặc cụm từ tìm kiếm\"}},computed:{notFoundImage:function(){return i(\"1fec\")}}},a=n,c=i(\"2877\"),o=Object(c[\"a\"])(a,s,r,!1,null,null,null);e[\"a\"]=o.exports}}]);","extractedComments":[]}