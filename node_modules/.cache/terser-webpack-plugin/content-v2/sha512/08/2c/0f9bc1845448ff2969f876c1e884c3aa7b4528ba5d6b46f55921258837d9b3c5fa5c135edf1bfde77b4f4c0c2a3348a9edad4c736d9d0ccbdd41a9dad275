{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-b71fa4c8\"],{5906:function(t,e,n){\"use strict\";n.d(e,\"d\",(function(){return i})),n.d(e,\"a\",(function(){return a})),n.d(e,\"b\",(function(){return r})),n.d(e,\"c\",(function(){return s}));var i={quantity:\"quantity\",product_type:\"product-type\",option:\"option\"},a=[{text:\"Product title\",value:\"title\"},{text:\"Variant title\",value:\"product_variant\"}],r=[{text:\"equals\",value:\"equal\"},{text:\"contains\",value:\"contain\"},{text:\"starts with\",value:\"start_with\"},{text:\"ends with\",value:\"end_with\"},{text:\"matches phrase\",value:\"match_phrase\"}],s=[{text:\"matches template\",value:\"match\"}]},6384:function(t,e,n){\"use strict\";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isFetching?n(\"PageDetailLoading\"):n(\"div\",{staticClass:\"page\"},[n(\"UnsavedBar\",{attrs:{show:t.isShowUnsavedBar,showDiscard:!0,loading:t.isSaving,title:\"Save\"},on:{save:t.save,discard:t.discard}}),n(\"div\",{staticClass:\"page-header\"},[n(\"h1\",{staticClass:\"page-title\"},[t._v(\"Quantity Detection Rules\")])]),n(\"div\",{staticClass:\"page-content container-fluid\"},[n(\"div\",{staticClass:\"row\"},[n(\"div\",{staticClass:\"col-12\"},[n(\"div\",{staticClass:\"card\"},[n(\"div\",{staticClass:\"card-block\"},[n(\"div\",{staticClass:\"card-title\"},[n(\"h4\",[t._v(\"\\n                Conditions\\n              \")])]),n(\"div\",[t._l(t.form.rules,(function(e,i){return n(\"condition-item\",{key:i,ref:\"conditions\",refInFor:!0,attrs:{condition:e,\"disable-remove\":0===i,type:\"quantity\"},on:{remove:function(e){return t.removeCondition(i)},input:function(e){return t.changeCondition(i,e)}}})})),n(\"div\",{staticClass:\"row\"},[n(\"div\",{staticClass:\"col-12 mt-2\"},[n(\"p-button\",{staticClass:\"mt-2\",attrs:{type:\"default\"},on:{click:function(e){return e.preventDefault(),t.addCondition(e)}}},[t._v(\"\\n                    Add new condition\\n                  \")])],1)])],2)])])])])])],1)},a=[],r=n(\"a34a\"),s=n.n(r),o=n(\"2f62\"),c=n(\"45ba\"),u=n(\"d6e0\"),l=n(\"5906\"),d=n(\"3984\");function p(t,e,n,i,a,r,s){try{var o=t[r](s),c=o.value}catch(u){return void n(u)}o.done?e(c):Promise.resolve(c).then(i,a)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var r=t.apply(e,n);function s(t){p(r,i,a,s,o,\"next\",t)}function o(t){p(r,i,a,s,o,\"throw\",t)}s(void 0)}))}}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g={name:\"SettingDetectQuantity\",components:{ConditionItem:u[\"a\"]},data:function(){return{form:{disjunctive:!0,product_type_id:0,type:l[\"d\"].quantity,rules:[{column:\"title\",relation:\"match\",condition:\"\"}]},initialForm:{},isShowUnsavedBar:!1,isFetching:!1,isSaving:!1}},computed:v({},Object(o[\"d\"])(\"orderMapping\",{quantityMappingState:function(t){return t.orderMapping},quantityMappingListState:function(t){return t.orderMappingsList}})),watch:{form:{handler:function(t){this.isShowUnsavedBar=Object(c[\"f\"])(t,this.initialForm)},deep:!0},initialForm:{handler:function(t){this.isShowUnsavedBar=Object(c[\"f\"])(t,this.form)},deep:!0}},methods:v(v(v({},Object(o[\"b\"])(\"orderMapping\",{fetchOrderMapping:\"fetchOrderMapping\",fetchOrderMappingList:\"fetchOrderMappingList\",createOrUpdateOrderMapping:\"createOrUpdateOrderMapping\"})),Object(o[\"c\"])(\"orderMapping\",{updateStateOrderMappings:d[\"FETCH_ORDER_MAPPINGS\"]})),{},{fetch:function(){var t=f(s.a.mark((function t(){var e;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isFetching=!0,t.next=3,this.fetchOrderMappingList({type:l[\"d\"].quantity});case 3:if(e=t.sent,!(e&&e.success&&this.quantityMappingListState.length>0)){t.next=9;break}return t.next=7,this.fetchOrderMapping({type:l[\"d\"].quantity,id:this.quantityMappingListState[0].id});case 7:e=t.sent,e&&e.success&&(this.form=Object(c[\"d\"])(this.quantityMappingState));case 9:this.initialForm=Object(c[\"d\"])(this.form),this.isFetching=!1;case 11:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),removeCondition:function(t){this.form.rules.splice(t,1)},changeCondition:function(t,e){this.$set(this.form.rules,t,e)},addCondition:function(){var t=this.form.rules;t.push(v(v({},t[t.length-1]),{},{condition:\"\"}))},discard:function(){this.form=Object(c[\"d\"])(this.initialForm)},save:function(){var t=f(s.a.mark((function t(){var e,n,i;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.$refs.conditions||!this.$refs.conditions.length){t.next=7;break}return t.next=3,Object(c[\"a\"])(this.$refs.conditions,function(){var t=f(s.a.mark((function t(e){var n;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validateAll();case 2:return n=t.sent,t.abrupt(\"return\",n);case 4:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:if(e=t.sent,n=e.length===this.$refs.conditions.length,n){t.next=7;break}return t.abrupt(\"return\");case 7:return this.isSaving=!0,t.next=10,this.createOrUpdateOrderMapping({type:l[\"d\"].quantity,payload:Object(c[\"d\"])(this.form)});case 10:if(i=t.sent,!i||!i.success){t.next=17;break}return this.$toast.open({type:\"success\",message:\"Saved successfully\"}),t.next=15,this.fetch();case 15:t.next=18;break;case 17:this.$toast.open({type:\"error\",message:i.message||\"Something went wrong. Please try again later\"});case 18:this.isSaving=!1;case 19:case\"end\":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}),beforeRouteLeave:function(t,e,n){this.updateStateOrderMappings([]),n()},created:function(){this.fetch()}},y=g,b=n(\"2877\"),O=Object(b[\"a\"])(y,i,a,!1,null,null,null);e[\"default\"]=O.exports},d6e0:function(t,e,n){\"use strict\";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"row\"},[n(\"div\",{staticClass:\"col-11\"},[n(\"div\",{staticClass:\"row\"},[n(\"div\",{staticClass:\"col-6 col-sm-4 mt-2 d-flex pr-2\"},[n(\"p-select\",{model:{value:t.internalValue.column,callback:function(e){t.$set(t.internalValue,\"column\",e)},expression:\"internalValue.column\"}},t._l(t.conditionColumns,(function(e){return n(\"option\",{key:e.value,domProps:{value:e.value}},[t._v(\"\\n            \"+t._s(e.text)+\"\\n          \")])})),0)],1),n(\"div\",{staticClass:\"col-6 col-sm-4 mt-2 d-flex px-2\"},[n(\"p-select\",{staticClass:\"flex-fill\",model:{value:t.internalValue.relation,callback:function(e){t.$set(t.internalValue,\"relation\",e)},expression:\"internalValue.relation\"}},t._l(t.relations,(function(e){return n(\"option\",{key:e.value,domProps:{value:e.value}},[t._v(\"\\n            \"+t._s(e.text)+\"\\n          \")])})),0)],1),t.selectedProperty?n(\"div\",{staticClass:\"col-12 col-sm-4 mt-2 mb-0 px-2 form-group\"},[n(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.internalValue.condition,expression:\"internalValue.condition\"},{name:\"validate\",rawName:\"v-validate\",value:\"required\",expression:\"'required'\"}],staticClass:\"flex-fill form-control\",class:[{\"is-invalid\":t.errors.has(\"condition\")}],attrs:{type:\"text\",name:\"condition\"},domProps:{value:t.internalValue.condition},on:{input:function(e){e.target.composing||t.$set(t.internalValue,\"condition\",e.target.value)}}}),t.errors.has(\"condition\")?n(\"div\",{staticClass:\"invalid-feedback\"},[t._v(\"\\n          Field is required\\n        \")]):t._e()]):t._e()])]),n(\"div\",{staticClass:\"col-1 mt-2 pl-2\"},[t.disableRemove?t._e():n(\"p-button\",{attrs:{type:\"default\",icon:\"close\"},on:{click:function(e){return e.preventDefault(),t.handleRemove(e)}}})],1)])},a=[],r=n(\"45ba\"),s=n(\"5906\"),o={name:\"ConditionItem\",props:{type:{type:String,default:s[\"d\"].product_type},condition:{type:Object,default:function(){return{column:\"tag\",relation:\"equals\",condition:\"\"}}},disableRemove:{type:Boolean,default:!1}},computed:{conditionColumns:function(){return s[\"a\"]},relations:function(){return this.type===s[\"d\"].quantity?s[\"c\"]:s[\"b\"]},selectedProperty:function(){var t=this;return this.conditionColumns.find((function(e){var n=e.value;return n===t.internalValue.column}))}},data:function(){return{internalValue:{}}},created:function(){this.internalValue=Object(r[\"d\"])(this.condition)},methods:{handleRemove:function(){this.$emit(\"remove\",this.value)}},watch:{condition:{handler:function(t){this.internalValue=Object(r[\"d\"])(t)},deep:!0},internalValue:{handler:function(t){JSON.stringify(this.internalValue)!=JSON.stringify(this.condition)&&this.$emit(\"input\",t)},deep:!0}}},c=o,u=n(\"2877\"),l=Object(u[\"a\"])(c,i,a,!1,null,null,null);e[\"a\"]=l.exports}}]);","extractedComments":[]}