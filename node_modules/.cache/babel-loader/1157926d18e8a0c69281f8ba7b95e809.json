{"remainingRequest":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/babel-loader/lib/index.js!/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/home/tiendzung/workspace/video5pm/video5pm-ui/src/core/services/socket.js","dependencies":[{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/src/core/services/socket.js","mtime":1603898990376},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/cache-loader/dist/cjs.js","mtime":1601450297498},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/babel-loader/lib/index.js","mtime":1597736171393},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1597736267502}],"contextDependencies":[],"result":["import AuthService from '@core/services/auth';\nexport var socket = {\n  conn: null,\n  connect: function connect(callbackMessage) {\n    var _this = this;\n\n    if (!window['WebSocket']) {\n      return this;\n    }\n\n    this.conn = new WebSocket(process.env.VUE_APP_WEBSOCKET_URL);\n    this.onOpen();\n    this.onMessage(function (e) {\n      callbackMessage(e);\n    });\n    this.onclose(function () {\n      setTimeout(function () {\n        _this.connect(callbackMessage);\n      }, 3000);\n    });\n    return this;\n  },\n  onOpen: function onOpen() {\n    var _this2 = this;\n\n    var token = AuthService.getAccessToken();\n\n    if (!token) {\n      return;\n    }\n\n    this.conn.addEventListener('open', function () {\n      _this2.conn.send(JSON.stringify({\n        type: 'connect',\n        token: token\n      }));\n    });\n  },\n  onclose: function onclose(callback) {\n    this.conn.onclose = function (e) {\n      console.log('web socket is disconnected');\n      callback(e);\n    };\n  },\n  onSend: function onSend(data) {\n    if (!data || !this.conn) {\n      return;\n    }\n\n    this.conn.send(data);\n  },\n  onMessage: function onMessage(callback) {\n    this.conn.addEventListener('message', function (e) {\n      callback(e);\n    });\n  },\n  onEvent: function onEvent(eventName, callback) {\n    this.conn.addEventListener(eventName, function (e) {\n      callback(e);\n    });\n  }\n};\nexport default socket;",{"version":3,"sources":["/home/tiendzung/workspace/video5pm/video5pm-ui/src/core/services/socket.js"],"names":["AuthService","socket","conn","connect","callbackMessage","window","WebSocket","process","env","VUE_APP_WEBSOCKET_URL","onOpen","onMessage","e","onclose","setTimeout","token","getAccessToken","addEventListener","send","JSON","stringify","type","callback","console","log","onSend","data","onEvent","eventName"],"mappings":"AAAA,OAAOA,WAAP,MAAwB,qBAAxB;AAEA,OAAO,IAAMC,MAAM,GAAG;AACpBC,EAAAA,IAAI,EAAE,IADc;AAGpBC,EAAAA,OAHoB,mBAGZC,eAHY,EAGK;AAAA;;AACvB,QAAI,CAACC,MAAM,CAAC,WAAD,CAAX,EAA0B;AACxB,aAAO,IAAP;AACD;;AAED,SAAKH,IAAL,GAAY,IAAII,SAAJ,CAAcC,OAAO,CAACC,GAAR,CAAYC,qBAA1B,CAAZ;AACA,SAAKC,MAAL;AACA,SAAKC,SAAL,CAAe,UAACC,CAAD,EAAO;AACpBR,MAAAA,eAAe,CAACQ,CAAD,CAAf;AACD,KAFD;AAGA,SAAKC,OAAL,CAAa,YAAM;AACjBC,MAAAA,UAAU,CAAC,YAAM;AACf,QAAA,KAAI,CAACX,OAAL,CAAaC,eAAb;AACD,OAFS,EAEP,IAFO,CAAV;AAGD,KAJD;AAMA,WAAO,IAAP;AACD,GApBmB;AAsBpBM,EAAAA,MAtBoB,oBAsBX;AAAA;;AACP,QAAMK,KAAK,GAAGf,WAAW,CAACgB,cAAZ,EAAd;;AACA,QAAI,CAACD,KAAL,EAAY;AACV;AACD;;AAED,SAAKb,IAAL,CAAUe,gBAAV,CAA2B,MAA3B,EAAmC,YAAM;AACvC,MAAA,MAAI,CAACf,IAAL,CAAUgB,IAAV,CAAeC,IAAI,CAACC,SAAL,CAAe;AAAEC,QAAAA,IAAI,EAAE,SAAR;AAAmBN,QAAAA,KAAK,EAAEA;AAA1B,OAAf,CAAf;AACD,KAFD;AAGD,GA/BmB;AAiCpBF,EAAAA,OAjCoB,mBAiCZS,QAjCY,EAiCF;AAChB,SAAKpB,IAAL,CAAUW,OAAV,GAAoB,UAASD,CAAT,EAAY;AAC9BW,MAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;AACAF,MAAAA,QAAQ,CAACV,CAAD,CAAR;AACD,KAHD;AAID,GAtCmB;AAwCpBa,EAAAA,MAxCoB,kBAwCbC,IAxCa,EAwCP;AACX,QAAI,CAACA,IAAD,IAAS,CAAC,KAAKxB,IAAnB,EAAyB;AACvB;AACD;;AAED,SAAKA,IAAL,CAAUgB,IAAV,CAAeQ,IAAf;AACD,GA9CmB;AAgDpBf,EAAAA,SAhDoB,qBAgDVW,QAhDU,EAgDA;AAClB,SAAKpB,IAAL,CAAUe,gBAAV,CAA2B,SAA3B,EAAsC,UAACL,CAAD,EAAO;AAC3CU,MAAAA,QAAQ,CAACV,CAAD,CAAR;AACD,KAFD;AAGD,GApDmB;AAsDpBe,EAAAA,OAtDoB,mBAsDZC,SAtDY,EAsDDN,QAtDC,EAsDS;AAC3B,SAAKpB,IAAL,CAAUe,gBAAV,CAA2BW,SAA3B,EAAsC,UAAChB,CAAD,EAAO;AAC3CU,MAAAA,QAAQ,CAACV,CAAD,CAAR;AACD,KAFD;AAGD;AA1DmB,CAAf;AA6DP,eAAeX,MAAf","sourcesContent":["import AuthService from '@core/services/auth'\n\nexport const socket = {\n  conn: null,\n\n  connect(callbackMessage) {\n    if (!window['WebSocket']) {\n      return this\n    }\n\n    this.conn = new WebSocket(process.env.VUE_APP_WEBSOCKET_URL)\n    this.onOpen()\n    this.onMessage((e) => {\n      callbackMessage(e)\n    })\n    this.onclose(() => {\n      setTimeout(() => {\n        this.connect(callbackMessage)\n      }, 3000)\n    })\n\n    return this\n  },\n\n  onOpen() {\n    const token = AuthService.getAccessToken()\n    if (!token) {\n      return\n    }\n\n    this.conn.addEventListener('open', () => {\n      this.conn.send(JSON.stringify({ type: 'connect', token: token }))\n    })\n  },\n\n  onclose(callback) {\n    this.conn.onclose = function(e) {\n      console.log('web socket is disconnected')\n      callback(e)\n    }\n  },\n\n  onSend(data) {\n    if (!data || !this.conn) {\n      return\n    }\n\n    this.conn.send(data)\n  },\n\n  onMessage(callback) {\n    this.conn.addEventListener('message', (e) => {\n      callback(e)\n    })\n  },\n\n  onEvent(eventName, callback) {\n    this.conn.addEventListener(eventName, (e) => {\n      callback(e)\n    })\n  },\n}\n\nexport default socket\n"]}]}