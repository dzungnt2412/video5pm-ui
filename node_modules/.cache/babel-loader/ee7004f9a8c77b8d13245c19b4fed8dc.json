{"remainingRequest":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/babel-loader/lib/index.js!/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/home/tiendzung/workspace/video5pm/video5pm-ui/src/kit/Upload/ajax.js","dependencies":[{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/src/kit/Upload/ajax.js","mtime":1603898990380},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/cache-loader/dist/cjs.js","mtime":1601450297498},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/babel-loader/lib/index.js","mtime":1597736171393},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1597736267502}],"contextDependencies":[],"result":["function getError(action, option, xhr) {\n  var msg;\n\n  if (xhr.response) {\n    msg = \"\".concat(xhr.response.error || xhr.response);\n  } else if (xhr.responseText) {\n    msg = \"\".concat(xhr.responseText);\n  } else {\n    msg = \"fail to post \".concat(action, \" \").concat(xhr.status);\n  }\n\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = 'post';\n  err.url = action;\n  return err;\n}\n\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n\n  if (!text) {\n    return text;\n  }\n\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n}\n\nexport default function upload(option) {\n  if (typeof XMLHttpRequest === 'undefined') {\n    return;\n  }\n\n  var xhr = new XMLHttpRequest();\n  var action = option.action;\n\n  if (xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n\n      option.onProgress(e);\n    };\n  }\n\n  var formData = new FormData();\n\n  if (option.data) {\n    Object.keys(option.data).forEach(function (key) {\n      formData.append(key, option.data[key]);\n    });\n  }\n\n  formData.append(option.filename, option.file, option.file.name);\n\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n\n  xhr.onload = function onload() {\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(action, option, xhr));\n    }\n\n    option.onSuccess(getBody(xhr));\n  };\n\n  xhr.open('post', action, true);\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n\n  var headers = option.headers || {};\n\n  for (var item in headers) {\n    if (headers.hasOwnProperty(item) && headers[item] !== null) {\n      xhr.setRequestHeader(item, headers[item]);\n    }\n  }\n\n  xhr.send(formData);\n  return xhr;\n}",{"version":3,"sources":["/home/tiendzung/workspace/video5pm/video5pm-ui/src/kit/Upload/ajax.js"],"names":["getError","action","option","xhr","msg","response","error","responseText","status","err","Error","method","url","getBody","text","JSON","parse","e","upload","XMLHttpRequest","onprogress","progress","total","percent","loaded","onProgress","formData","FormData","data","Object","keys","forEach","key","append","filename","file","name","onerror","onError","onload","onSuccess","open","withCredentials","headers","item","hasOwnProperty","setRequestHeader","send"],"mappings":"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","sourcesContent":["function getError(action, option, xhr) {\n  let msg\n  if (xhr.response) {\n    msg = `${xhr.response.error || xhr.response}`\n  } else if (xhr.responseText) {\n    msg = `${xhr.responseText}`\n  } else {\n    msg = `fail to post ${action} ${xhr.status}`\n  }\n\n  const err = new Error(msg)\n  err.status = xhr.status\n  err.method = 'post'\n  err.url = action\n  return err\n}\n\nfunction getBody(xhr) {\n  const text = xhr.responseText || xhr.response\n  if (!text) {\n    return text\n  }\n\n  try {\n    return JSON.parse(text)\n  } catch (e) {\n    return text\n  }\n}\n\nexport default function upload(option) {\n  if (typeof XMLHttpRequest === 'undefined') {\n    return\n  }\n\n  const xhr = new XMLHttpRequest()\n  const action = option.action\n\n  if (xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = (e.loaded / e.total) * 100\n      }\n      option.onProgress(e)\n    }\n  }\n\n  const formData = new FormData()\n\n  if (option.data) {\n    Object.keys(option.data).forEach((key) => {\n      formData.append(key, option.data[key])\n    })\n  }\n\n  formData.append(option.filename, option.file, option.file.name)\n\n  xhr.onerror = function error(e) {\n    option.onError(e)\n  }\n\n  xhr.onload = function onload() {\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(action, option, xhr))\n    }\n\n    option.onSuccess(getBody(xhr))\n  }\n\n  xhr.open('post', action, true)\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true\n  }\n\n  const headers = option.headers || {}\n\n  for (let item in headers) {\n    if (headers.hasOwnProperty(item) && headers[item] !== null) {\n      xhr.setRequestHeader(item, headers[item])\n    }\n  }\n  xhr.send(formData)\n  return xhr\n}\n"]}]}