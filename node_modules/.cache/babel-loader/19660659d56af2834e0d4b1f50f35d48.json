{"remainingRequest":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/babel-loader/lib/index.js!/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tiendzung/workspace/video5pm/video5pm-ui/src/packages/design/views/Form.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/src/packages/design/views/Form.vue","mtime":1604479001989},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/cache-loader/dist/cjs.js","mtime":1604479000133},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/babel-loader/lib/index.js","mtime":1604479000077},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/cache-loader/dist/cjs.js","mtime":1604479000133},{"path":"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/vue-loader/lib/index.js","mtime":1604479001773}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/home/tiendzung/workspace/video5pm/video5pm-ui/node_modules/@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/*eslint-disable*/\nimport { mapActions, mapState } from 'vuex';\nimport mixinUpload from '@/core/mixins/upload';\nimport Thumbnail from '@components/shared/Thumbnail';\nimport mixinCreateDesign from '../mixins/create-design';\nimport { Upload } from '@kit';\nimport { MAX_DESIGN_FILE } from '@core/constants';\nimport { CREATE_DESIGN, FETCH_DESIGN, FETCH_DESIGNS, UPDATE_DESIGN, DELETE_DESIGN, UPDATE_DESIGN_SKU, DELETE_DESIGN_FILES, DOWNLOAD_DESIGN } from '../store';\nimport ModalCreateDesign from './components/ModalCreateDesign';\nimport { cloneDeep } from '@core/utils';\nimport Browser from '@core/helpers/browser';\nimport designApi from '../api';\nimport ProductTypeResource from '@/components/shared/resource/ProductType';\nimport AuthService from '@core/services/auth';\nexport default {\n  name: 'DesignForm',\n  mixins: [mixinUpload, mixinCreateDesign],\n  components: {\n    Thumbnail: Thumbnail,\n    Upload: Upload,\n    ModalCreateDesign: ModalCreateDesign,\n    ProductTypeResource: ProductTypeResource\n  },\n  computed: _objectSpread(_objectSpread(_objectSpread({}, mapState('design', {\n    currentDesign: function currentDesign(state) {\n      return state.design;\n    },\n    currentDesignFiles: function currentDesignFiles(state) {\n      return state.design.design_files;\n    }\n  })), mapState('shared', {\n    productBases: function productBases(state) {\n      return state.productBases;\n    }\n  })), {}, {\n    validFiles: function validFiles() {\n      var _this = this;\n\n      return this.files.filter(function (_ref) {\n        var uid = _ref.uid;\n        return _this.uploadedIds.indexOf(uid) === -1;\n      });\n    },\n    userInformation: function userInformation() {\n      if (this.design && this.design.user) {\n        return [this.design.user.full_name, this.design.user.username, this.design.user.email, this.design.user.phone].filter(Boolean);\n      }\n\n      return [];\n    }\n  }),\n  data: function data() {\n    return {\n      design: {\n        sku: '',\n        files: []\n      },\n      productNames: {},\n      files: [],\n      preview: [],\n      isFetching: false,\n      isSaving: false,\n      isChange: false,\n      uploadReady: true,\n      uploadedIds: [],\n      isChangeSku: false,\n      changeProductIds: [],\n      designFiles: [],\n      isLoading: false,\n      showBtnSave: false,\n      disableUpload: false\n    };\n  },\n  mounted: function mounted() {\n    this.handleBeforeLeave();\n  },\n  methods: _objectSpread(_objectSpread({}, mapActions('design', [FETCH_DESIGN, UPDATE_DESIGN, DELETE_DESIGN, UPDATE_DESIGN_SKU, DELETE_DESIGN_FILES, DOWNLOAD_DESIGN])), {}, {\n    init: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.isFetching = true;\n\n                if (!this.$route.params.id) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _context.next = 4;\n                return this.getDesign();\n\n              case 4:\n                this.isFetching = false;\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    getDesign: function () {\n      var _getDesign = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var id, result;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                id = parseInt(this.$route.params.id, 10);\n                _context2.next = 3;\n                return this.fetchDesign(id);\n\n              case 3:\n                result = _context2.sent;\n                this.isChange = false;\n\n                if (result.success) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                this.$toast.open({\n                  type: 'error',\n                  message: result.message\n                });\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                this.design = cloneDeep(this.currentDesign);\n                this.designFiles = cloneDeep(this.currentDesign.design_files);\n\n                if (this.designFiles.length) {\n                  this.showBtnSave = true;\n                }\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getDesign() {\n        return _getDesign.apply(this, arguments);\n      }\n\n      return getDesign;\n    }(),\n    handleSave: function () {\n      var _handleSave = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var payload, result;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this.isSaving = true;\n                payload = {\n                  id: this.design.id,\n                  body: {\n                    design_files: this.changeProductIds\n                  }\n                };\n                _context3.next = 4;\n                return this.updateDesign(payload);\n\n              case 4:\n                result = _context3.sent;\n                this.isSaving = false;\n\n                if (result.success) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                this.$toast.open({\n                  type: 'error',\n                  message: result.message\n                });\n                return _context3.abrupt(\"return\");\n\n              case 9:\n                this.$toast.open({\n                  type: 'success',\n                  message: 'Update design successful'\n                });\n                this.isChange = false;\n                this.init();\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function handleSave() {\n        return _handleSave.apply(this, arguments);\n      }\n\n      return handleSave;\n    }(),\n    handleDiscard: function handleDiscard() {},\n    beforeUpload: function beforeUpload() {\n      if (this.designFiles.length >= MAX_DESIGN_FILE) {\n        this.$toast.open({\n          type: 'error',\n          message: \"Design can not upload more than \".concat(MAX_DESIGN_FILE, \" file\")\n        });\n        this.disableUpload = true;\n        return false;\n      }\n\n      this.isChange = true;\n      return true;\n    },\n    handleChangeFile: function handleChangeFile(file) {\n      if (this.disableUpload) {\n        return;\n      }\n\n      var index = this.files.findIndex(function (_ref2) {\n        var uid = _ref2.uid;\n        return uid === file.uid;\n      });\n\n      if (index === -1) {\n        this.files.push(file);\n      } else {\n        this.$set(this.files, index, file);\n      }\n    },\n    handleSuccess: function handleSuccess(val, file) {\n      if (val && typeof val.design_file !== 'undefined') {\n        this.designFiles.push(val.design_file);\n      }\n\n      this.showBtnSave = true;\n    },\n    showDeleteConfirmation: function showDeleteConfirmation(item) {\n      var _this2 = this;\n\n      this.$dialog.confirm({\n        title: \"Remove design file?\",\n        message: \"Are you sure you want to remove this design file?\",\n        confirmText: 'Remove',\n        onConfirm: function onConfirm() {\n          return _this2.handleDelete(item);\n        },\n        type: 'danger'\n      });\n    },\n    handleDelete: function () {\n      var _handleDelete = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(item) {\n        var payload, result;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.isSaving = true;\n                payload = {\n                  id: item.id,\n                  design_id: item.design_id\n                };\n                _context4.next = 4;\n                return this.deleteDesignFile(payload);\n\n              case 4:\n                result = _context4.sent;\n                this.isSaving = false;\n\n                if (result.success) {\n                  _context4.next = 9;\n                  break;\n                }\n\n                this.$toast.open({\n                  type: 'error',\n                  message: result.message\n                });\n                return _context4.abrupt(\"return\");\n\n              case 9:\n                this.isChange = true;\n                this.$toast.open({\n                  type: 'success',\n                  message: 'Delete design file successful'\n                });\n                this.designFiles = this.designFiles.filter(function (x) {\n                  return x !== item;\n                });\n\n                if (this.designFiles.length === 0) {\n                  this.showBtnSave = false;\n                }\n\n              case 13:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function handleDelete(_x) {\n        return _handleDelete.apply(this, arguments);\n      }\n\n      return handleDelete;\n    }(),\n    handleBeforeLeave: function handleBeforeLeave() {\n      window.onbeforeunload = function () {\n        if (this.isChange) {\n          return 'If you leave this page, all unsaved changes will be lost. Are you sure you want to leave this page?';\n        }\n\n        return null;\n      }.bind(this);\n    },\n    handlerChangeSku: function () {\n      var _handlerChangeSku = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var payload, result;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                this.isSaving = true;\n                payload = {\n                  id: this.design.id,\n                  sku: this.design.sku\n                };\n                _context5.next = 4;\n                return this.updateDesignSku(payload);\n\n              case 4:\n                result = _context5.sent;\n                this.isSaving = false;\n\n                if (result.success) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                this.$toast.open({\n                  type: 'error',\n                  message: result.message\n                });\n                return _context5.abrupt(\"return\");\n\n              case 9:\n                this.isChangeSku = false;\n                this.$toast.open({\n                  type: 'success',\n                  message: 'Update design sku successful'\n                });\n\n              case 11:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function handlerChangeSku() {\n        return _handlerChangeSku.apply(this, arguments);\n      }\n\n      return handlerChangeSku;\n    }(),\n    handleDownloadFile: function () {\n      var _handleDownloadFile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(id) {\n        var url;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                this.isLoading = true;\n                url = \"\".concat(process.env.VUE_APP_BASE_API_ENDPOINT, \"/designs/files/\").concat(id, \"/download?access_token=\").concat(AuthService.getAccessToken());\n                window.open(url, '_self');\n                this.isLoading = false;\n\n              case 4:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function handleDownloadFile(_x2) {\n        return _handleDownloadFile.apply(this, arguments);\n      }\n\n      return handleDownloadFile;\n    }(),\n    handleCreateZipDesign: function () {\n      var _handleCreateZipDesign = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n        var payload, result;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                this.isSaving = true;\n                payload = {\n                  id: this.design.id,\n                  sku: this.design.sku\n                };\n                _context7.next = 4;\n                return this.updateDesignSku(payload);\n\n              case 4:\n                result = _context7.sent;\n                this.isSaving = false;\n                this.isChange = false;\n\n                if (result.success) {\n                  _context7.next = 10;\n                  break;\n                }\n\n                this.$toast.open({\n                  type: 'error',\n                  message: 'Update design failed !'\n                });\n                return _context7.abrupt(\"return\");\n\n              case 10:\n                this.$toast.open({\n                  type: 'success',\n                  message: 'Update design success !'\n                });\n                this.isChangeSku = false;\n                this.init();\n\n              case 13:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function handleCreateZipDesign() {\n        return _handleCreateZipDesign.apply(this, arguments);\n      }\n\n      return handleCreateZipDesign;\n    }(),\n    handlerDeleteDesign: function () {\n      var _handlerDeleteDesign = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n        var payload, result;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                if (!(this.design.design_files && this.design.design_files.length > 0)) {\n                  _context8.next = 3;\n                  break;\n                }\n\n                this.$toast.open({\n                  type: 'error',\n                  message: 'Cant delete design contains the file'\n                });\n                return _context8.abrupt(\"return\");\n\n              case 3:\n                this.isSaving = true;\n                payload = {\n                  id: this.design.id\n                };\n                _context8.next = 7;\n                return this.deleteDesign(payload);\n\n              case 7:\n                result = _context8.sent;\n                this.isSaving = false;\n\n                if (!result.success) {\n                  _context8.next = 13;\n                  break;\n                }\n\n                this.$toast.open('Delete design successful');\n                this.$router.push({\n                  name: 'design-list'\n                });\n                return _context8.abrupt(\"return\");\n\n              case 13:\n                this.$toast.open({\n                  type: 'error',\n                  message: result.message\n                });\n\n              case 14:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function handlerDeleteDesign() {\n        return _handlerDeleteDesign.apply(this, arguments);\n      }\n\n      return handlerDeleteDesign;\n    }(),\n    showConfirmDeleteDesign: function showConfirmDeleteDesign() {\n      var _this3 = this;\n\n      this.$dialog.confirm({\n        title: \"Delete design?\",\n        message: \"Are you sure you want to delete this design?\",\n        confirmText: 'Delete',\n        onConfirm: function onConfirm() {\n          return _this3.handlerDeleteDesign();\n        },\n        type: 'danger'\n      });\n    },\n    handlerCancelChangeSku: function handlerCancelChangeSku() {\n      this.isChangeSku = false;\n      this.design.sku = this.currentDesign.sku;\n    }\n  }),\n  watch: {\n    '$route.params.id': {\n      handler: function handler() {\n        this.init();\n      },\n      immediate: true\n    }\n  },\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    if (this.isChange) {\n      if (!window.confirm('If you leave this page, all unsaved changes will be lost. Are you sure you want to leave this page?')) {\n        return;\n      }\n    }\n\n    next();\n  }\n};",{"version":3,"sources":["Form.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <PageDetailLoading v-if=\"isFetching\"></PageDetailLoading>\n  <div class=\"page\" v-else>\n    <div class=\"page-header pb-0\">\n      <div class=\"row\">\n        <div class=\"col-12\">\n          <p-button icon=\"chevron-left\" class=\"btn-pure pl-0\">\n            <router-link :to=\"{ name: 'design-list' }\">Designs</router-link>\n          </p-button>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div\n          class=\"col-12  d-flex align-items-center justify-content-between mb-20\"\n        >\n          <h4>\n            Update Design\n            <span v-if=\"design && !isChangeSku\">\n              : {{ design.sku }}\n              <a href=\"#\" @click=\"isChangeSku = !isChangeSku\"\n                ><p-icon name=\"edit\" iconPack=\"md\"></p-icon\n              ></a>\n            </span>\n            <div style=\"display: inline-block;\">\n              <div\n                v-if=\"design && isChangeSku\"\n                class=\"input-group input-group-sm\"\n              >\n                <input\n                  type=\"text\"\n                  class=\"form-control\"\n                  v-model=\"design.sku\"\n                  v-validate=\"'required|min:3'\"\n                />\n                <div class=\"input-group-btn\">\n                  <p-button\n                    :type=\"'primary'\"\n                    :disabled=\"isSaving\"\n                    :loading=\"isSaving || isLoading\"\n                    :size=\"'sm'\"\n                    @click=\"handlerChangeSku\"\n                    >Ok</p-button\n                  >\n                  <button\n                    class=\"btn btn-sm btn-danger\"\n                    @click=\"handlerCancelChangeSku\"\n                    :loading=\"isLoading\"\n                    >Cancel</button\n                  >\n                </div>\n              </div>\n            </div>\n          </h4>\n          <div class=\"page-header-group-actions__left\">\n            <p-button\n              :type=\"'primary'\"\n              class=\"ml-10\"\n              v-if=\"design.status == 1 || isChange\"\n              @click.prevent=\"handleCreateZipDesign\"\n            >\n              Lựu lại\n            </p-button>\n            <p-button\n              :type=\"'danger'\"\n              class=\"ml-10\"\n              @click.prevent=\"showConfirmDeleteDesign\"\n            >\n              Xóa\n            </p-button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"page-content container-fluid\">\n      <div class=\"row\">\n        <div class=\"col-12 col-md-8\">\n          <div class=\"card\">\n            <div class=\"card-block\">\n              <div class=\"card-title\">\n                <h4>\n                  Design Files\n                </h4>\n              </div>\n              <div v-if=\"isFetching\" class=\"text-center mb-50 mt-50\">\n                <div class=\"loader vertical-align-middle loader-circle\"></div>\n              </div>\n              <div\n                class=\"gallery row\"\n                v-else-if=\"designFiles && designFiles.length\"\n              >\n                <div\n                  class=\"col-6 col-sm-4\"\n                  v-for=\"(item, i) in designFiles\"\n                  :key=\"i\"\n                >\n                  <div class=\"gallery-item\">\n                    <thumbnail :src=\"item.url\" />\n                    <template v-if=\"!item.is_edit\">\n                      <div class=\"gallery-item__actions\">\n                        <a\n                          href=\"#\"\n                          @click.prevent=\"handleDownloadFile(item.id)\"\n                          class=\"ml-5\"\n                        >\n                          <p-icon name=\"download\" icon-pack=\"md\"></p-icon>\n                        </a>\n                        <a\n                          href=\"#\"\n                          @click.prevent=\"showDeleteConfirmation(item)\"\n                          class=\"ml-5\"\n                        >\n                          <p-icon\n                            name=\"close\"\n                            icon-pack=\"md\"\n                            @click.prevent=\"showDeleteConfirmation(item)\"\n                          ></p-icon>\n                        </a>\n                      </div>\n                    </template>\n                  </div>\n                </div>\n              </div>\n              <div class=\"text-center mt-40 mb-40\" v-else>\n                <svg\n                  width=\"192\"\n                  height=\"135\"\n                  viewBox=\"0 0 192 128\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <g fill=\"none\">\n                    <path\n                      fill=\"#E9EBED\"\n                      d=\"M138.049 43.407L95.873 33.248v79.494l42.176-11.04z\"\n                    ></path>\n                    <path\n                      fill=\"#DFE0E2\"\n                      d=\"M53.696 43.407l42.177-10.159v79.494l-42.177-10.82z\"\n                    ></path>\n                    <path\n                      fill=\"#F5F6F7\"\n                      d=\"M95.52 33.6l22.214-18.459 42.174 10.822-22.211 17.794z\"\n                    ></path>\n                    <path\n                      fill=\"#E0E0E0\"\n                      d=\"M32.408 26.534l21.64 17.223 42.175-10.156-21.418-18.107z\"\n                    ></path>\n                    <path\n                      fill=\"#EEF0F1\"\n                      d=\"M32.058 26.184l22.166 17.573L96.4 33.601 74.453 15.14z\"\n                    ></path>\n                    <path\n                      fill=\"#E9EBED\"\n                      d=\"M53.696 43.407v58.516l42.177 10.819.569-58.074z\"\n                    ></path>\n                    <path\n                      fill=\"#DFE0E2\"\n                      d=\"M138.049 101.702l-42.176 11.04V54.668l42.176-11.261z\"\n                    ></path>\n                    <path\n                      fill=\"#000\"\n                      opacity=\".06\"\n                      d=\"M121.266 82.269v19.212l16.783-4.639v-19.21z\"\n                    ></path>\n                    <path\n                      fill=\"#000\"\n                      opacity=\".04\"\n                      d=\"M53.145 73.769l23.627 5.962 18.991-15.458v-9.495L53.587 44.179z\"\n                    ></path>\n                    <path\n                      fill=\"#000\"\n                      opacity=\".04\"\n                      d=\"M138.38 73.769l-23.628 5.962-18.989-15.458v-9.495l42.174-10.599z\"\n                    ></path>\n                    <path\n                      fill=\"#F5F6F7\"\n                      d=\"M53.696 43.407L32.058 61.293l42.174 10.598 21.64-17.223z\"\n                    ></path>\n                    <path\n                      fill=\"#E0E0E0\"\n                      d=\"M138.049 43.407l21.86 17.886-41.956 10.598-22.08-17.223z\"\n                    ></path>\n                    <path\n                      fill=\"#EEF0F1\"\n                      d=\"M138.049 43.407l21.86 17.886-41.956 10.598-22.08-17.223z\"\n                    ></path>\n                  </g>\n                </svg>\n                <p>\n                  No design files have been uploaded yet\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"col-12 col-md-4\">\n          <section class=\"card\">\n            <div class=\"card-block\">\n              <div class=\"card-title\">\n                <h4>\n                  Upload\n                </h4>\n              </div>\n\n              <upload\n                class=\"design-uploader\"\n                :action=\"createEndpoint(`designs/${$route.params.id}/files`)\"\n                drag\n                multiple\n                list-type=\"picture\"\n                :headers=\"uploadHeaders\"\n                :on-change=\"handleChangeFile\"\n                :on-success=\"handleSuccess\"\n                :max-file-size=\"100000000\"\n                :before-upload=\"beforeUpload\"\n              >\n                <p-icon\n                  name=\"cloud-upload\"\n                  icon-pack=\"md\"\n                  class=\"el-icon-upload\"\n                ></p-icon>\n                <div class=\"el-upload__text\">\n                  Drop file here or <em>click to upload</em>\n                </div>\n              </upload>\n              <div class=\"el-upload__tip\"\n                >jpg/png files with a size less than 100mb</div\n              >\n              <div class=\"gallery-list\">\n                <div\n                  class=\"gallery-list__item\"\n                  v-for=\"(item, i) in validFiles\"\n                  :key=\"i\"\n                >\n                  <div class=\"gallery-list__item-top\">\n                    <div class=\"gallery-list__item-group\">\n                      <div class=\"gallery-list__item-group--thumbnail\">\n                        <img :src=\"item.url\" alt=\"Preview\" v-if=\"item.url\" />\n                        <p-icon v-else name=\"image\" icon-pack=\"md\"></p-icon>\n                      </div>\n                      <p>{{ item.name }}</p>\n                    </div>\n                    <div\n                      class=\"gallery-list__item-label\"\n                      v-if=\"item.status === 'fail'\"\n                    >\n                      <span>Error</span>\n                    </div>\n                  </div>\n\n                  <div\n                    class=\"gallery-list__item-bottom\"\n                    v-if=\"item.percentage && item.status !== 'fail'\"\n                  >\n                    <p-progress\n                      :value=\"item.percentage\"\n                      show-value\n                      format=\"percent\"\n                      type=\"primary\"\n                    ></p-progress>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </section>\n          <section\n            class=\"card\"\n            v-if=\"userInformation && userInformation.length\"\n          >\n            <div class=\"card-block\">\n              <div class=\"card-title\">\n                <h4>\n                  User information\n                </h4>\n              </div>\n              <p class=\"card-text\">\n                <span v-for=\"(item, i) in userInformation\" :key=\"i\">\n                  {{ item }}\n                  <br />\n                </span>\n              </p>\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n\n    <modal-create-design\n      :visible.sync=\"isVisibleCreateDesign\"\n      :create-design=\"createDesign\"\n      v-if=\"isVisibleCreateDesign\"\n      @created=\"handleCreateDesignDesign\"\n    />\n  </div>\n</template>\n<script>\n/*eslint-disable*/\nimport { mapActions, mapState } from 'vuex'\nimport mixinUpload from '@/core/mixins/upload'\nimport Thumbnail from '@components/shared/Thumbnail'\nimport mixinCreateDesign from '../mixins/create-design'\nimport { Upload } from '@kit'\nimport { MAX_DESIGN_FILE } from '@core/constants'\nimport {\n  CREATE_DESIGN,\n  FETCH_DESIGN,\n  FETCH_DESIGNS,\n  UPDATE_DESIGN,\n  DELETE_DESIGN,\n  UPDATE_DESIGN_SKU,\n  DELETE_DESIGN_FILES,\n  DOWNLOAD_DESIGN,\n} from '../store'\nimport ModalCreateDesign from './components/ModalCreateDesign'\nimport { cloneDeep } from '@core/utils'\nimport Browser from '@core/helpers/browser'\nimport designApi from '../api'\nimport ProductTypeResource from '@/components/shared/resource/ProductType'\nimport AuthService from '@core/services/auth'\n\nexport default {\n  name: 'DesignForm',\n  mixins: [mixinUpload, mixinCreateDesign],\n  components: { Thumbnail, Upload, ModalCreateDesign, ProductTypeResource },\n  computed: {\n    ...mapState('design', {\n      currentDesign: (state) => state.design,\n      currentDesignFiles: (state) => state.design.design_files,\n    }),\n    ...mapState('shared', {\n      productBases: (state) => state.productBases,\n    }),\n    validFiles() {\n      return this.files.filter(\n        ({ uid }) => this.uploadedIds.indexOf(uid) === -1\n      )\n    },\n    userInformation() {\n      if (this.design && this.design.user) {\n        return [\n          this.design.user.full_name,\n          this.design.user.username,\n          this.design.user.email,\n          this.design.user.phone,\n        ].filter(Boolean)\n      }\n      return []\n    },\n  },\n  data() {\n    return {\n      design: {\n        sku: '',\n        files: [],\n      },\n      productNames: {},\n      files: [],\n      preview: [],\n      isFetching: false,\n      isSaving: false,\n      isChange: false,\n      uploadReady: true,\n      uploadedIds: [],\n      isChangeSku: false,\n      changeProductIds: [],\n      designFiles: [],\n      isLoading: false,\n      showBtnSave: false,\n      disableUpload: false,\n    }\n  },\n  mounted() {\n    this.handleBeforeLeave()\n  },\n  methods: {\n    ...mapActions('design', [\n      FETCH_DESIGN,\n      UPDATE_DESIGN,\n      DELETE_DESIGN,\n      UPDATE_DESIGN_SKU,\n      DELETE_DESIGN_FILES,\n      DOWNLOAD_DESIGN,\n    ]),\n    async init() {\n      this.isFetching = true\n      if (this.$route.params.id) {\n        await this.getDesign()\n      }\n      this.isFetching = false\n    },\n    async getDesign() {\n      const id = parseInt(this.$route.params.id, 10)\n      const result = await this.fetchDesign(id)\n      this.isChange = false\n\n      if (!result.success) {\n        this.$toast.open({ type: 'error', message: result.message })\n        return\n      }\n\n      this.design = cloneDeep(this.currentDesign)\n      this.designFiles = cloneDeep(this.currentDesign.design_files)\n      if (this.designFiles.length) {\n        this.showBtnSave = true\n      }\n    },\n\n    async handleSave() {\n      this.isSaving = true\n\n      const payload = {\n        id: this.design.id,\n        body: {\n          design_files: this.changeProductIds,\n        },\n      }\n\n      const result = await this.updateDesign(payload)\n      this.isSaving = false\n\n      if (!result.success) {\n        this.$toast.open({ type: 'error', message: result.message })\n        return\n      }\n\n      this.$toast.open({ type: 'success', message: 'Update design successful' })\n      this.isChange = false\n      this.init()\n    },\n\n    handleDiscard() {},\n\n    beforeUpload() {\n      if (this.designFiles.length >= MAX_DESIGN_FILE) {\n        this.$toast.open({\n          type: 'error',\n          message: `Design can not upload more than ${MAX_DESIGN_FILE} file`,\n        })\n        this.disableUpload = true\n        return false\n      }\n\n      this.isChange = true\n      return true\n    },\n    handleChangeFile(file) {\n      if (this.disableUpload) {\n        return\n      }\n\n      const index = this.files.findIndex(({ uid }) => uid === file.uid)\n      if (index === -1) {\n        this.files.push(file)\n      } else {\n        this.$set(this.files, index, file)\n      }\n    },\n\n    handleSuccess(val, file) {\n      if (val && typeof val.design_file !== 'undefined') {\n        this.designFiles.push(val.design_file)\n      }\n      this.showBtnSave = true\n    },\n\n    showDeleteConfirmation(item) {\n      this.$dialog.confirm({\n        title: `Remove design file?`,\n        message: `Are you sure you want to remove this design file?`,\n        confirmText: 'Remove',\n        onConfirm: () => this.handleDelete(item),\n        type: 'danger',\n      })\n    },\n\n    async handleDelete(item) {\n      this.isSaving = true\n\n      const payload = {\n        id: item.id,\n        design_id: item.design_id,\n      }\n      const result = await this.deleteDesignFile(payload)\n      this.isSaving = false\n\n      if (!result.success) {\n        this.$toast.open({ type: 'error', message: result.message })\n        return\n      }\n\n      this.isChange = true\n      this.$toast.open({\n        type: 'success',\n        message: 'Delete design file successful',\n      })\n      this.designFiles = this.designFiles.filter((x) => x !== item)\n      if (this.designFiles.length === 0) {\n        this.showBtnSave = false\n      }\n    },\n\n    handleBeforeLeave() {\n      window.onbeforeunload = function() {\n        if (this.isChange) {\n          return 'If you leave this page, all unsaved changes will be lost. Are you sure you want to leave this page?'\n        }\n\n        return null\n      }.bind(this)\n    },\n\n    async handlerChangeSku() {\n      this.isSaving = true\n      const payload = {\n        id: this.design.id,\n        sku: this.design.sku,\n      }\n      const result = await this.updateDesignSku(payload)\n      this.isSaving = false\n\n      if (!result.success) {\n        this.$toast.open({ type: 'error', message: result.message })\n        return\n      }\n\n      this.isChangeSku = false\n      this.$toast.open({\n        type: 'success',\n        message: 'Update design sku successful',\n      })\n    },\n\n    async handleDownloadFile(id) {\n      this.isLoading = true\n      const url = `${\n        process.env.VUE_APP_BASE_API_ENDPOINT\n      }/designs/files/${id}/download?access_token=${AuthService.getAccessToken()}`\n      window.open(url, '_self')\n      this.isLoading = false\n    },\n\n    async handleCreateZipDesign() {\n      this.isSaving = true\n      const payload = {\n        id: this.design.id,\n        sku: this.design.sku,\n      }\n      const result = await this.updateDesignSku(payload)\n      this.isSaving = false\n      this.isChange = false\n\n      if (!result.success) {\n        this.$toast.open({ type: 'error', message: 'Update design failed !' })\n        return\n      }\n\n      this.$toast.open({ type: 'success', message: 'Update design success !' })\n      this.isChangeSku = false\n      this.init()\n    },\n\n    async handlerDeleteDesign() {\n      if (this.design.design_files && this.design.design_files.length > 0) {\n        this.$toast.open({\n          type: 'error',\n          message: 'Cant delete design contains the file',\n        })\n        return\n      }\n\n      this.isSaving = true\n      const payload = {\n        id: this.design.id,\n      }\n\n      const result = await this.deleteDesign(payload)\n      this.isSaving = false\n\n      if (result.success) {\n        this.$toast.open('Delete design successful')\n        this.$router.push({ name: 'design-list' })\n        return\n      }\n\n      this.$toast.open({ type: 'error', message: result.message })\n    },\n\n    showConfirmDeleteDesign() {\n      this.$dialog.confirm({\n        title: `Delete design?`,\n        message: `Are you sure you want to delete this design?`,\n        confirmText: 'Delete',\n        onConfirm: () => this.handlerDeleteDesign(),\n        type: 'danger',\n      })\n    },\n\n    handlerCancelChangeSku() {\n      this.isChangeSku = false\n      this.design.sku = this.currentDesign.sku\n    },\n  },\n  watch: {\n    '$route.params.id': {\n      handler: function() {\n        this.init()\n      },\n      immediate: true,\n    },\n  },\n  beforeRouteLeave(to, from, next) {\n    if (this.isChange) {\n      if (\n        !window.confirm(\n          'If you leave this page, all unsaved changes will be lost. Are you sure you want to leave this page?'\n        )\n      ) {\n        return\n      }\n    }\n\n    next()\n  },\n}\n</script>\n<style scoped>\n.gallery-item__label {\n  top: 10px;\n  left: 10px;\n  color: #ffff;\n  cursor: pointer;\n  font-weight: bold;\n  font-size: 15px;\n  opacity: 1;\n}\n.mutiple-search {\n  z-index: 4;\n  position: absolute;\n  top: 0;\n}\n.multiselect.multiselect-custom {\n  width: 100%;\n}\n</style>\n<style>\n.multiselect__tags {\n  border-radius: 0 !important;\n}\n</style>\n"],"sourceRoot":"src/packages/design/views"}]}